import datetime
import pytest
from construct import Container, ListContainer

mf = pytest.importorskip("rtm_con.msg_format")

def compare_container(parsed_data, py_obj):
    if isinstance(parsed_data, ListContainer):
        for value, value_target in zip(parsed_data, py_obj):
            compare_container(value, value_target)
    elif isinstance(parsed_data, Container):
        for key, value_target in py_obj.items():
            value = parsed_data[key]
            compare_container(value, value_target)
    else:
        assert parsed_data == py_obj, f"Parsed data doesn't match expectation\nparsed:\n{parsed_data}\ntarget:\n{py_obj}"

def check_data(test_samples, check_build=True):
    for msg_con in (mf.msg, mf.msg_checked):
        for msg_hex, target in test_samples:
            print(msg_hex)
            print(target)
            b = bytes.fromhex(msg_hex)
            msg = msg_con.parse(b)
            compare_container(msg, target)
            if check_build:
                build_hex = msg_con.build(target).hex()
                assert build_hex == msg_hex, f"Build data doesn't match orignal bytes\nbuild:\n{build_hex}\norignal:\n{msg_hex}"

def test_msg_login():
    check_data((
        ('242401fe484155563442474e365335303032323139010036190a1b140202000c3839383630393234373930303233313636363036010130524a50454130304841553041414631333130303139353596',
            {'starter': 'protocol_2025',
            'msg_type': 'login',
            'ack': 'command',
            'vin': 'HAUV4BGN6S5002219',
            'enc': 'uncrypted',
            'payload': {'timestamp': datetime.datetime(2025, 10, 27, 20, 2, 2),
                        'session_id': 12,
                        'iccid': '89860924790023166606',
                        'bms_total': 1,
                        'pack_per_bms': [1],
                        'pack_sn_list': [['0RJPEA00HAU0AAF131001955']]},
            'checksum': 150}
        ),
        ('242401fe484155563442474e365335303032323139010067190a1b140202000c383938363039323437393030323331363636303602010230524a50454130304841553041414631333130303139353530524a50454130304841553041414631333130303139353630524a504541303048415530414146313331303031393537c7',
            {'starter': 'protocol_2025',
            'msg_type': 'login',
            'ack': 'command',
            'vin': 'HAUV4BGN6S5002219',
            'enc': 'uncrypted',
            'payload': {'timestamp': datetime.datetime(2025, 10, 27, 20, 2, 2),
                        'session_id': 12,
                        'iccid': '89860924790023166606',
                        'bms_total': 2,
                        'pack_per_bms': [1, 2],
                        'pack_sn_list': [['0RJPEA00HAU0AAF131001955'],
                                        ['0RJPEA00HAU0AAF131001956',
                                        '0RJPEA00HAU0AAF131001957']]},
            'checksum': 199}
        ),
        ('232301fe484155563442474e365335303032323139010066190a1b140202000c3839383630393234373930303233313636363036031830524a50454130304841553041414631333130303139353530524a50454130304841553041414631333130303139353630524a504541303048415530414146313331303031393537dc',
            {'starter': 'protocol_2016',
            'msg_type': 'login',
            'ack': 'command',
            'vin': 'HAUV4BGN6S5002219',
            'enc': 'uncrypted',
            'payload': {'timestamp': datetime.datetime(2025, 10, 27, 20, 2, 2),
                        'session_id': 12,
                        'iccid': '89860924790023166606',
                        'bms_total': 3,
                        'pack_sn_len': 24,
                        'pack_sn': ['0RJPEA00HAU0AAF131001955',
                                    '0RJPEA00HAU0AAF131001956',
                                    '0RJPEA00HAU0AAF131001957']},
            'checksum': 220}
        ),
    ))

def test_msg_whole_vehicle_data():
    check_data((
        ("242402fe484155563442474e365335303032323139010026190a1b14020201ffffffffffffffffffffffffffffffbfffffff010003aabbcc0004aabbccdd8f",
            {'starter': 'protocol_2025',
            'msg_type': 'realtime',
            'ack': 'command',
            'vin': 'HAUV4BGN6S5002219',
            'enc': 'uncrypted',
            'payload': {'timestamp': datetime.datetime(2025, 10, 27, 20, 2, 2),
                        'data_list': [{'data_type': 'whole_vehicle',
                                        'data_content': {'vehicle_state': 'invalid',
                                                        'charge_state': 'invalid',
                                                        'operate_state': 'invalid',
                                                        'vehicle_speed': '6553.5 invalid',
                                                        'mileage_total': '429496729.5 invalid',
                                                        'voltage_total': '6553.5 invalid',
                                                        'current_total': '3553.5 invalid',
                                                        'soc': '255 invalid',
                                                        'dcdc_state': 'invalid',
                                                        'gear_state': {'gear_postion_validity': 'invalid',
                                                                        'driving_force': 1,
                                                                        'braking_force': 1,
                                                                        'gear': 'P'},
                                                        'insulation_resistance': '65535 '
                                                                                'invalid'}}],
                        'sig_starter': 'ff',
                        'sig': {'algo': 'sm2',
                                'r_len': 3,
                                'r_value': 'aabbcc',
                                's_len': 4,
                                's_value': 'aabbccdd'}},
            'checksum': 143}
        ),
        ("232302fe484155563442474e36533530303232313901001b190a1b14020201ffffffffffffffffffffffffffffff3fffffffff16",
            {'starter': 'protocol_2016',
            'msg_type': 'realtime',
            'ack': 'command',
            'vin': 'HAUV4BGN6S5002219',
            'enc': 'uncrypted',
            'payload': {'timestamp': datetime.datetime(2025, 10, 27, 20, 2, 2),
                        'data_list': [{'data_type': 'whole_vehicle',
                                        'data_content': {'vehicle_state': 'invalid',
                                                        'charge_state': 'invalid',
                                                        'operate_state': 'invalid',
                                                        'vehicle_speed': '6553.5 invalid',
                                                        'mileage_total': '429496729.5 '
                                                                        'invalid',
                                                        'voltage_total': '6553.5 invalid',
                                                        'current_total': '5553.5 invalid',
                                                        'soc': '255 invalid',
                                                        'dcdc_state': 'invalid',
                                                        'gear_state': {'driving_force': 1,
                                                                        'braking_force': 1,
                                                                        'gear': 'P'},
                                                        'insulation_resistance': '65535 '
                                                                                'kΩ',
                                                        'accelerator_padel': '255 invalid',
                                                        'brake_padel': '255 invalid'}}]},
            'checksum': 22}
        ),
    ))

def test_msg_e_motor_data():
    check_data((
        ("232302fe484155563442474e365335303032323139010020190a1b1402020202fffffffffffffffffffffffffefefefefefefefefefefefeec",
            {'starter': 'protocol_2016',
            'msg_type': 'realtime',
            'ack': 'command',
            'vin': 'HAUV4BGN6S5002219',
            'enc': 'uncrypted',
            'payload': {'timestamp': datetime.datetime(2025, 10, 27, 20, 2, 2),
                        'data_list': [{'data_type': 'emotor',
                                        'data_content': [{'index': 255,
                                                        'state': 'invalid',
                                                        'ctrl_temp': '215 invalid',
                                                        'speed': '45535 invalid',
                                                        'torque': '4553.5 invalid',
                                                        'temp': '215 invalid',
                                                        'ctrl_volt': '6553.5 invalid',
                                                        'ctrl_curr': '5553.5 invalid'},
                                                        {'index': 254,
                                                        'state': 'abnormal',
                                                        'ctrl_temp': '214 abnormal',
                                                        'speed': '45278 rpm',
                                                        'torque': '4527.8 N·m',
                                                        'temp': '214 abnormal',
                                                        'ctrl_volt': '6527.8 V',
                                                        'ctrl_curr': '5527.8 A'}]}]},
            'checksum': 236}
        ),
        ("242402fe484155563442474e365335303032323139010029190a1b1402020202fffffffffffffffffffffefefefefefefefefefeff010003aabbcc0004aabbccddc1",
            {'starter': 'protocol_2025',
            'msg_type': 'realtime',
            'ack': 'command',
            'vin': 'HAUV4BGN6S5002219',
            'enc': 'uncrypted',
            'payload': {'timestamp': datetime.datetime(2025, 10, 27, 20, 2, 2),
                        'data_list': [{'data_type': 'emotor',
                                        'data_content': [{'index': 255,
                                                        'state': 'invalid',
                                                        'ctrl_temp': '215 invalid',
                                                        'speed': '33535 invalid',
                                                        'torque': '429476729.5 invalid',
                                                        'temp': '215 invalid'},
                                                        {'index': 254,
                                                        'state': 'abnormal',
                                                        'ctrl_temp': '214 abnormal',
                                                        'speed': '33278 rpm',
                                                        'torque': '427792428.6 N·m',
                                                        'temp': '214 abnormal'}]}],
                        'sig_starter': 'ff',
                        'sig': {'algo': 'sm2',
                                'r_len': 3,
                                'r_value': 'aabbcc',
                                's_len': 4,
                                's_value': 'aabbccdd'}},
            'checksum': 193}
        ),
    ))

def test_msg_engine_data():
    check_data((
        ("232302fe484155563442474e36533530303232313901000c190a1b14020204ffffffffff3b",
            {'starter': 'protocol_2016',
            'msg_type': 'realtime',
            'ack': 'command',
            'vin': 'HAUV4BGN6S5002219',
            'enc': 'uncrypted',
            'payload': {'timestamp': datetime.datetime(2025, 10, 27, 20, 2, 2),
                        'data_list': [{'data_type': 'engine',
                                        'data_content': {'engine_state': 'invalid',
                                                        'engine_torque': '65535 invalid',
                                                        'fuel_consumption': '655.35 '
                                                                            'invalid'}}]},
            'checksum': 59}
        ),
        ("242402fe484155563442474e365335303032323139010016190a1b14020204ffffff010003aabbcc0004aabbccddfa",
            {'starter': 'protocol_2025',
            'msg_type': 'realtime',
            'ack': 'command',
            'vin': 'HAUV4BGN6S5002219',
            'enc': 'uncrypted',
            'payload': {'timestamp': datetime.datetime(2025, 10, 27, 20, 2, 2),
                        'data_list': [{'data_type': 'engine',
                                        'data_content': {'engine_torque': '65535 '
                                                                        'invalid'}}],
                        'sig_starter': 'ff',
                        'sig': {'algo': 'sm2',
                                'r_len': 3,
                                'r_value': 'aabbcc',
                                's_len': 4,
                                's_value': 'aabbccdd'}},
            'checksum': 250}
        ),
    ))

def test_msg_gnss_data():
    check_data((
        ("232302fe484155563442474e365335303032323139010010190a1b1402020507ffffffffffffffffde",
            {'starter': 'protocol_2016',
            'msg_type': 'realtime',
            'ack': 'command',
            'vin': 'HAUV4BGN6S5002219',
            'enc': 'uncrypted',
            'payload': {'timestamp': datetime.datetime(2025, 10, 27, 20, 2, 2),
                        'data_list': [{'data_type': 'gnss',
                                        'data_content': {'gnss_state': {'gnss_e_w': 'w',
                                                                        'gnss_n_s': 's',
                                                                        'gnss_valid': 1},
                                                        'gnss_lng': '4294.9672949999995 '
                                                                    'invalid',
                                                        'gnss_lat': '4294.9672949999995 '
                                                                    'invalid'}}]},
            'checksum': 222}
        ),
        ("242402fe484155563442474e36533530303232313901001e190a1b1402020507ffffffffffffffffffff010003aabbcc0004aabbccdd0b",
            {'starter': 'protocol_2025',
            'msg_type': 'realtime',
            'ack': 'command',
            'vin': 'HAUV4BGN6S5002219',
            'enc': 'uncrypted',
            'payload': {'timestamp': datetime.datetime(2025, 10, 27, 20, 2, 2),
                        'data_list': [{'data_type': 'gnss',
                                        'data_content': {'gnss_state': {'gnss_e_w': 'w',
                                                                        'gnss_n_s': 's',
                                                                        'gnss_valid': 1},
                                                        'gnss_gcs': 255,
                                                        'gnss_lng': '4294.9672949999995 '
                                                                    'invalid',
                                                        'gnss_lat': '4294.9672949999995 '
                                                                    'invalid'}}],
                        'sig_starter': 'ff',
                        'sig': {'algo': 'sm2',
                                'r_len': 3,
                                'r_value': 'aabbcc',
                                's_len': 4,
                                's_value': 'aabbccdd'}},
            'checksum': 11}
        ),
    ))

def test_msg_extrema_data():
    check_data((
        ("232302fe484155563442474e365335303032323139010015190a1b14020206ffffffffffffffffffffffffffffdf",
            {'starter': 'protocol_2016',
            'msg_type': 'realtime',
            'ack': 'command',
            'vin': 'HAUV4BGN6S5002219',
            'enc': 'uncrypted',
            'payload': {'timestamp': datetime.datetime(2025, 10, 27, 20, 2, 2),
                        'data_list': [{'data_type': 'pack_extrema',
                                        'data_content': {'max_volt_pack_index': '255 '
                                                                                'invalid',
                                                        'max_volt_cell_index': '255 '
                                                                                'invalid',
                                                        'max_cell_volt': '65.535 invalid',
                                                        'min_volt_pack_index': '255 '
                                                                                'invalid',
                                                        'min_volt_cell_index': '255 '
                                                                                'invalid',
                                                        'min_cell_volt': '65.535 invalid',
                                                        'max_temp_pack_index': '255 '
                                                                                'invalid',
                                                        'max_temp_cell_index': '255 '
                                                                                'invalid',
                                                        'max_cell_temp': '215 invalid',
                                                        'min_temp_pack_index': '255 '
                                                                                'invalid',
                                                        'min_temp_cell_index': '255 '
                                                                                'invalid',
                                                        'min_cell_temp': '215 invalid'}}]},
            'checksum': 223}
        ),
    ))

def test_msg_warnings_data():
    check_data((
        ("232302fe484155563442474e36533530303232313901002c190a1b14020207030000000300000007000100030008000200080003000c0004000d000100060920000a000bc9",
            {'starter': 'protocol_2016',
            'msg_type': 'realtime',
            'ack': 'command',
            'vin': 'HAUV4BGN6S5002219',
            'enc': 'uncrypted',
            'payload': {'timestamp': datetime.datetime(2025, 10, 27, 20, 2, 2),
                        'data_list': [{'data_type': 'warnings',
                                        'data_content': {'max_warning_level': 3,
                                                        'general_warnings': {'temp_differentce_warning': 1,
                                                                            'pack_high_temp_warning': 1,
                                                                            'pack_over_volt_warning': 0,
                                                                            'pack_under_volt_warning': 0,
                                                                            'soc_low_warning': 0,
                                                                            'cell_over_volt_warning': 0,
                                                                            'cell_under_volt_warning': 0,
                                                                            'soc_high_warning': 0,
                                                                            'soc_jump_warning': 0,
                                                                            'pack_unmatched_warning': 0,
                                                                            'cell_poor_consistency_warning': 0,
                                                                            'insulation_warning': 0,
                                                                            'dcdc_temp_warning': 0,
                                                                            'brake_system_wanring': 0,
                                                                            'dcdc_state_warning': 0,
                                                                            'emotor_driver_temp_warning': 0,
                                                                            'hv_interlock_warning': 0,
                                                                            'emotor_temp_warning': 0,
                                                                            'pack_over_charged_warning': 0},
                                                        'pack_failures': [],
                                                        'emotor_failures': [],
                                                        'engine_failures': [],
                                                        'other_failures': ['00010003',
                                                                            '00080002',
                                                                            '00080003',
                                                                            '000c0004',
                                                                            '000d0001',
                                                                            '00060920',
                                                                            '000a000b']}}]},
            'checksum': 201}
        ),
        ("242402fe484155563442474e36533530303232313901003e190a1b14020206030000000300000007000100030008000200080003000c0004000d000100060920000a000b0200030103ff010003aabbcc0004aabbccddfd",
            {'starter': 'protocol_2025',
            'msg_type': 'realtime',
            'ack': 'command',
            'vin': 'HAUV4BGN6S5002219',
            'enc': 'uncrypted',
            'payload': {'timestamp': datetime.datetime(2025, 10, 27, 20, 2, 2),
                        'data_list': [{'data_type': 'warnings',
                                        'data_content': {'max_warning_level': 3,
                                                        'general_warnings': {'temp_differentce_warning': 1,
                                                                            'pack_high_temp_warning': 1,
                                                                            'pack_over_volt_warning': 0,
                                                                            'pack_under_volt_warning': 0,
                                                                            'soc_low_warning': 0,
                                                                            'cell_over_volt_warning': 0,
                                                                            'cell_under_volt_warning': 0,
                                                                            'soc_high_warning': 0,
                                                                            'soc_jump_warning': 0,
                                                                            'pack_unmatched_warning': 0,
                                                                            'cell_poor_consistency_warning': 0,
                                                                            'insulation_warning': 0,
                                                                            'dcdc_temp_warning': 0,
                                                                            'brake_system_wanring': 0,
                                                                            'dcdc_state_warning': 0,
                                                                            'emotor_driver_temp_warning': 0,
                                                                            'hv_interlock_warning': 0,
                                                                            'emotor_temp_warning': 0,
                                                                            'pack_over_charged_warning': 0,
                                                                            'emotor_over_speed_warning': 0,
                                                                            'emotor_over_curr_warning': 0,
                                                                            'super_capacitor_over_temp_warning': 0,
                                                                            'super_capacitor_over_pressure_warning': 0,
                                                                            'pack_thermal_event_warning': 0,
                                                                            'hydrogen_leakage_warning': 0,
                                                                            'hydrogen_system_presure_abnormal_warning': 0,
                                                                            'hydrogen_system_temp_abnormal_warning': 0,
                                                                            'fuel_cell_stack_over_temp_warning': 0},
                                                        'pack_failures': [],
                                                        'emotor_failures': [],
                                                        'engine_failures': [],
                                                        'other_failures': ['00010003',
                                                                            '00080002',
                                                                            '00080003',
                                                                            '000c0004',
                                                                            '000d0001',
                                                                            '00060920',
                                                                            '000a000b'],
                                                        'general_warning_list': [{'warning': 'temp_differentce_warning',
                                                                                'level': 3},
                                                                                {'warning': 'pack_high_temp_warning',
                                                                                'level': 3}]}}],
                        'sig_starter': 'ff',
                        'sig': {'algo': 'sm2',
                                'r_len': 3,
                                'r_value': 'aabbcc',
                                's_len': 4,
                                's_value': 'aabbccdd'}},
            'checksum': 253}
        ),
    ))

def test_msg_cell_volts_data():
    check_data((
        ("232302fe484155563442474e36533530303232313901002a190a1b1402020802ffffffffffffffffff04ffffffffffffffffffffffffffffffffff03ffffffffffffeb",
            {'starter': 'protocol_2016',
            'msg_type': 'realtime',
            'ack': 'command',
            'vin': 'HAUV4BGN6S5002219',
            'enc': 'uncrypted',
            'payload': {'timestamp': datetime.datetime(2025, 10, 27, 20, 2, 2),
                        'data_list': [{'data_type': 'cell_volts',
                                        'data_content': [{'index': '255 invalid',
                                                        'volt': '6553.5 invalid',
                                                        'curr': '3553.5 invalid',
                                                        'cell_total': '65535 invalid',
                                                        'cell_start_index': 65535,
                                                        'cell_volts': ['65.535 invalid',
                                                                        '65.535 invalid',
                                                                        '65.535 invalid',
                                                                        '65.535 invalid']},
                                                        {'index': '255 invalid',
                                                        'volt': '6553.5 invalid',
                                                        'curr': '3553.5 invalid',
                                                        'cell_total': '65535 invalid',
                                                        'cell_start_index': 65535,
                                                        'cell_volts': ['65.535 invalid',
                                                                        '65.535 invalid',
                                                                        '65.535 '
                                                                        'invalid']}]}]},
            'checksum': 235}
        ),
        ("242402fe484155563442474e365335303032323139010031190a1b1402020702ffffffffff0004ffffffffffffffffffffffffff0003ffffffffffffff010003aabbcc0004aabbccdddb",
            {'starter': 'protocol_2025',
            'msg_type': 'realtime',
            'ack': 'command',
            'vin': 'HAUV4BGN6S5002219',
            'enc': 'uncrypted',
            'payload': {'timestamp': datetime.datetime(2025, 10, 27, 20, 2, 2),
                        'data_list': [{'data_type': 'cell_volts',
                                        'data_content': [{'index': '255 invalid',
                                                        'volt': '6553.5 invalid',
                                                        'curr': '3553.5 invalid',
                                                        'cell_volts': ['65.535 invalid',
                                                                        '65.535 invalid',
                                                                        '65.535 invalid',
                                                                        '65.535 invalid']},
                                                        {'index': '255 invalid',
                                                        'volt': '6553.5 invalid',
                                                        'curr': '3553.5 invalid',
                                                        'cell_volts': ['65.535 invalid',
                                                                        '65.535 invalid',
                                                                        '65.535 '
                                                                        'invalid']}]}],
                        'sig_starter': 'ff',
                        'sig': {'algo': 'sm2',
                                'r_len': 3,
                                'r_value': 'aabbcc',
                                's_len': 4,
                                's_value': 'aabbccdd'}},
            'checksum': 219}
        ),
    ))

def test_msg_probe_temps_data():
    check_data((
        ("232302fe484155563442474e365335303032323139010013190a1b1402020902ff0000050005ffffffffffd4",
            {'starter': 'protocol_2016',
            'msg_type': 'realtime',
            'ack': 'command',
            'vin': 'HAUV4BGN6S5002219',
            'enc': 'uncrypted',
            'payload': {'timestamp': datetime.datetime(2025, 10, 27, 20, 2, 2),
                        'data_list': [{'data_type': 'probe_temps',
                                        'data_content': [{'index': '255 invalid',
                                                        'probe_temps': []},
                                                        {'index': '5',
                                                        'probe_temps': ['215 invalid',
                                                                        '215 invalid',
                                                                        '215 invalid',
                                                                        '215 invalid',
                                                                        '215 '
                                                                        'invalid']}]}]},
            'checksum': 212}
        ),
        ("242402fe484155563442474e365335303032323139010020190a1b1402020802ff0000050005ffffffffffff010003aabbcc0004aabbccddc2",
            {'starter': 'protocol_2025',
            'msg_type': 'realtime',
            'ack': 'command',
            'vin': 'HAUV4BGN6S5002219',
            'enc': 'uncrypted',
            'payload': {'timestamp': datetime.datetime(2025, 10, 27, 20, 2, 2),
                        'data_list': [{'data_type': 'probe_temps',
                                        'data_content': [{'index': '255 invalid',
                                                        'probe_temps': []},
                                                        {'index': '5',
                                                        'probe_temps': ['215 invalid',
                                                                        '215 invalid',
                                                                        '215 invalid',
                                                                        '215 invalid',
                                                                        '215 '
                                                                        'invalid']}]}],
                        'sig_starter': 'ff',
                        'sig': {'algo': 'sm2',
                                'r_len': 3,
                                'r_value': 'aabbcc',
                                's_len': 4,
                                's_value': 'aabbccdd'}},
            'checksum': 194}
        ),
    ))

def test_msg_oem_data():
    check_data((
        ("232302fe484155563442474e365335303032323139010019190a1b140202800010fefefefefefefefefefefefefefefefe45",
            {'starter': 'protocol_2016',
            'msg_type': 'realtime',
            'ack': 'command',
            'vin': 'HAUV4BGN6S5002219',
            'enc': 'uncrypted',
            'payload': {'timestamp': datetime.datetime(2025, 10, 27, 20, 2, 2),
                        'data_list': [{'data_type': 128,
                                        'data_content': 'fefefefefefefefefefefefefefefefe'}]},
            'checksum': 69}
        ),
        ("242402fe484155563442474e365335303032323139010026190a1b140202800010fefefefefefefefefefefefefefefefeff010003aabbcc0004aabbccdd5e",
            {'starter': 'protocol_2025',
            'msg_type': 'realtime',
            'ack': 'command',
            'vin': 'HAUV4BGN6S5002219',
            'enc': 'uncrypted',
            'payload': {'timestamp': datetime.datetime(2025, 10, 27, 20, 2, 2),
                        'data_list': [{'data_type': 128,
                                        'data_content': 'fefefefefefefefefefefefefefefefe'}],
                        'sig_starter': 'ff',
                        'sig': {'algo': 'sm2',
                                'r_len': 3,
                                'r_value': 'aabbcc',
                                's_len': 4,
                                's_value': 'aabbccdd'}},
            'checksum': 94}
        ),
    ))

def test_msg_logout():
    check_data((
        ("232304fe484155563442474e365335303032323139010008190a1b1402020802c8",
            {'starter': 'protocol_2016',
            'msg_type': 'logout',
            'ack': 'command',
            'vin': 'HAUV4BGN6S5002219',
            'enc': 'uncrypted',
            'payload': {'timestamp': datetime.datetime(2025, 10, 27, 20, 2, 2),
                        'session_id': 2050},
            'checksum': 200}
        ),
        ("242404fe484155563442474e365335303032323139010008190a1b1402020802c8",
            {'starter': 'protocol_2025',
            'msg_type': 'logout',
            'ack': 'command',
            'vin': 'HAUV4BGN6S5002219',
            'enc': 'uncrypted',
            'payload': {'timestamp': datetime.datetime(2025, 10, 27, 20, 2, 2),
                        'session_id': 2050},
            'checksum': 200}
        ),
    ))

def test_msg_plt_login():
    check_data((
        ("232305fe484155563442474e365335303032323139010029190a1b1402020802484155563442474e36533530484155563442474e365335303032323139484155018d",
            {'starter': 'protocol_2016',
            'msg_type': 'plt_login',
            'ack': 'command',
            'vin': 'HAUV4BGN6S5002219',
            'enc': 'uncrypted',
            'payload': {'timestamp': datetime.datetime(2025, 10, 27, 20, 2, 2),
                        'session_id': 2050,
                        'username': 'HAUV4BGN6S50',
                        'password': 'HAUV4BGN6S5002219HAU',
                        'enc': 'uncrypted'},
            'checksum': 141}
        ),
        ("242405fe484155563442474e365335303032323139010029190a1b1402020802484155563442474e36533530484155563442474e365335303032323139484155018d",
            {'starter': 'protocol_2025',
            'msg_type': 'plt_login',
            'ack': 'command',
            'vin': 'HAUV4BGN6S5002219',
            'enc': 'uncrypted',
            'payload': {'timestamp': datetime.datetime(2025, 10, 27, 20, 2, 2),
                        'session_id': 2050,
                        'username': 'HAUV4BGN6S50',
                        'password': 'HAUV4BGN6S5002219HAU',
                        'enc': 'uncrypted'},
            'checksum': 141}
        ),
    ))

def test_msg_plt_logout():
    check_data((
        ("232306fe484155563442474e365335303032323139010008190a1b1402020802ca",
            {'starter': 'protocol_2016',
            'msg_type': 'plt_logout',
            'ack': 'command',
            'vin': 'HAUV4BGN6S5002219',
            'enc': 'uncrypted',
            'payload': {'timestamp': datetime.datetime(2025, 10, 27, 20, 2, 2),
                        'session_id': 2050},
            'checksum': 202}
        ),
        ("242406fe484155563442474e365335303032323139010008190a1b1402020802ca",
            {'starter': 'protocol_2025',
            'msg_type': 'plt_logout',
            'ack': 'command',
            'vin': 'HAUV4BGN6S5002219',
            'enc': 'uncrypted',
            'payload': {'timestamp': datetime.datetime(2025, 10, 27, 20, 2, 2),
                        'session_id': 2050},
            'checksum': 202}
        ),
    ))

def test_msg_ack():
    check_data((
        ("23230101484155563442474e365335303032323139010006190a1b14020236",
            {'starter': 'protocol_2016',
            'msg_type': 'login',
            'ack': 'ok',
            'vin': 'HAUV4BGN6S5002219',
            'enc': 'uncrypted',
            'payload': {'timestamp': datetime.datetime(2025, 10, 27, 20, 2, 2)},
            'checksum': 54}
        ),
        ("24240101484155563442474e365335303032323139010006190a1b14020236",
            {'starter': 'protocol_2025',
            'msg_type': 'login',
            'ack': 'ok',
            'vin': 'HAUV4BGN6S5002219',
            'enc': 'uncrypted',
            'payload': {'timestamp': datetime.datetime(2025, 10, 27, 20, 2, 2)},
            'checksum': 54}
        ),
    ))

def test_msg_activation():
    check_data((
        ("242409fe48474c48334143463150413731343430380102311906170f0616313233343536373831323334353637380103ce6f0a94cbece0c56ba8e4eda6dbf838d5374536b0b5e9b57db2abe2ace31abc8f9c2a72c8a71c2128e999c354733542b034a5fc521d7c2124bb3c7eff16c2f1161c11f7e38aebf17a69a2d68d23d78730b98b0d1c867076f44003786e35b89fda73130a48211959521cc613c9978f622f328383350bf334e4a7a80208981123d384d4f8685189240f8ebc56dfc4c0628a044466bc13c833dde1bea636147892069c6c294923e4c6c8aa64d0e981a0f8135d1c332ef9fdc7c3612b37decb5df6cc8e4040cf912b845456d169807b494805eeed7aec09f22b344f0ed029375f49903bd704515e319509aeacf3c50daaed3561c9a54879f13ff0790a499c96d3c101000148474c4833414346315041373134343038020100be3b4d48647b90fd359f5365b700850ff095c360470336505bfd7393454bd782719567968e021109f2d21ebf8aa4548020336dc21e6afdc07d4897cbc25b007c02e28c971d626acf4ed30d2197735480d5489967bd7bc336da1e9a6f12c3e9fdb60a1c00f237042f8f82e31a51307e97f77d4bfb50b5cbcd80c1711a5adb0d7e8be9650222e71273a3642fe65e93e437deaef46f257f389fdfac889333ca759ce7ec5027879c4d8bf872df84a2ed1cab4c7a2e92ccabde77b22dee19af32f371360f67b0310fbae66201c8f68e8d2e709f692951bca151a6ac509443fafcd565fda62b3b5d4d5b7350995699f7b1f39b60b4ef6791f6d8a75661bef055fe93c70000f1",
            {'starter': 'protocol_2025',
            'msg_type': 'activation',
            'ack': 'command',
            'vin': 'HGLH3ACF1PA714408',
            'enc': 'uncrypted',
            'payload': {'timestamp': datetime.datetime(2025, 6, 23, 15, 6, 22),
                        'sec_chip_id': '1234567812345678',
                        'pubkey_len': 259,
                        'pubkey': 'ce6f0a94cbece0c56ba8e4eda6dbf838d5374536b0b5e9b57db2abe2ace31abc8f9c2a72c8a71c2128e999c354733542b034a5fc521d7c2124bb3c7eff16c2f1161c11f7e38aebf17a69a2d68d23d78730b98b0d1c867076f44003786e35b89fda73130a48211959521cc613c9978f622f328383350bf334e4a7a80208981123d384d4f8685189240f8ebc56dfc4c0628a044466bc13c833dde1bea636147892069c6c294923e4c6c8aa64d0e981a0f8135d1c332ef9fdc7c3612b37decb5df6cc8e4040cf912b845456d169807b494805eeed7aec09f22b344f0ed029375f49903bd704515e319509aeacf3c50daaed3561c9a54879f13ff0790a499c96d3c1010001',
                        'vin': 'HGLH3ACF1PA714408',
                        'sig': {'algo': 'rsa',
                                'r_len': 256,
                                'r_value': 'be3b4d48647b90fd359f5365b700850ff095c360470336505bfd7393454bd782719567968e021109f2d21ebf8aa4548020336dc21e6afdc07d4897cbc25b007c02e28c971d626acf4ed30d2197735480d5489967bd7bc336da1e9a6f12c3e9fdb60a1c00f237042f8f82e31a51307e97f77d4bfb50b5cbcd80c1711a5adb0d7e8be9650222e71273a3642fe65e93e437deaef46f257f389fdfac889333ca759ce7ec5027879c4d8bf872df84a2ed1cab4c7a2e92ccabde77b22dee19af32f371360f67b0310fbae66201c8f68e8d2e709f692951bca151a6ac509443fafcd565fda62b3b5d4d5b7350995699f7b1f39b60b4ef6791f6d8a75661bef055fe93c7',
                                's_len': 0,
                                's_value': ''}},
            'checksum': 241}
        ),
        ("24240afe48474c48334143463150413731343430380100020201a6",
            {'starter': 'protocol_2025',
            'msg_type': 'activation_response',
            'ack': 'command',
            'vin': 'HGLH3ACF1PA714408',
            'enc': 'uncrypted',
            'payload': {'activation_result': 'nok', 'activation_info': 'ok'},
            'checksum': 166}
        ),
    ))

def test_msg_weird_data1():
    check_data((
        # Weird message with duplicated warning blocks and umatched general warning flags and codes
        ("232302fe484155563442474e365335303032323139010052190a1b14020207030000000300000007000100030008000200080003000c0004000d000100060920000a000b07030000000300000007000100030008000200080003000c0004000d000100060920000a000b9e",
            {'starter': 'protocol_2016',
            'msg_type': 'realtime',
            'ack': 'command',
            'vin': 'HAUV4BGN6S5002219',
            'enc': 'uncrypted',
            'payload': {'timestamp': datetime.datetime(2025, 10, 27, 20, 2, 2),
                        'data_list': [{'data_type': 'warnings',
                                        'data_content': {'max_warning_level': 3,
                                                        'general_warnings': {'temp_differentce_warning': 1,
                                                                            'pack_high_temp_warning': 1,
                                                                            'pack_over_volt_warning': 0,
                                                                            'pack_under_volt_warning': 0,
                                                                            'soc_low_warning': 0,
                                                                            'cell_over_volt_warning': 0,
                                                                            'cell_under_volt_warning': 0,
                                                                            'soc_high_warning': 0,
                                                                            'soc_jump_warning': 0,
                                                                            'pack_unmatched_warning': 0,
                                                                            'cell_poor_consistency_warning': 0,
                                                                            'insulation_warning': 0,
                                                                            'dcdc_temp_warning': 0,
                                                                            'brake_system_wanring': 0,
                                                                            'dcdc_state_warning': 0,
                                                                            'emotor_driver_temp_warning': 0,
                                                                            'hv_interlock_warning': 0,
                                                                            'emotor_temp_warning': 0,
                                                                            'pack_over_charged_warning': 0},
                                                        'pack_failures': [],
                                                        'emotor_failures': [],
                                                        'engine_failures': [],
                                                        'other_failures': ['00010003',
                                                                            '00080002',
                                                                            '00080003',
                                                                            '000c0004',
                                                                            '000d0001',
                                                                            '00060920',
                                                                            '000a000b']}},
                                    {'data_type': 'warnings',
                                        'data_content': {'max_warning_level': 3,
                                                        'general_warnings': {'temp_differentce_warning': 1,
                                                                            'pack_high_temp_warning': 1,
                                                                            'pack_over_volt_warning': 0,
                                                                            'pack_under_volt_warning': 0,
                                                                            'soc_low_warning': 0,
                                                                            'cell_over_volt_warning': 0,
                                                                            'cell_under_volt_warning': 0,
                                                                            'soc_high_warning': 0,
                                                                            'soc_jump_warning': 0,
                                                                            'pack_unmatched_warning': 0,
                                                                            'cell_poor_consistency_warning': 0,
                                                                            'insulation_warning': 0,
                                                                            'dcdc_temp_warning': 0,
                                                                            'brake_system_wanring': 0,
                                                                            'dcdc_state_warning': 0,
                                                                            'emotor_driver_temp_warning': 0,
                                                                            'hv_interlock_warning': 0,
                                                                            'emotor_temp_warning': 0,
                                                                            'pack_over_charged_warning': 0},
                                                        'pack_failures': [],
                                                        'emotor_failures': [],
                                                        'engine_failures': [],
                                                        'other_failures': ['00010003',
                                                                            '00080002',
                                                                            '00080003',
                                                                            '000c0004',
                                                                            '000d0001',
                                                                            '00060920',
                                                                            '000a000b']}}]},
            'checksum': 158}
        ),
        ("242402fe484155563442474e365335303032323139010069190a1b14020206030000000300000007000100030008000200080003000c0004000d000100060920000a000b020002010306030000000300000007000100030008000200080003000c0004000d000100060920000a000b0204020103ff010003aabbcc0004aabbccdd85",
            {'starter': 'protocol_2025',
            'msg_type': 'realtime',
            'ack': 'command',
            'vin': 'HAUV4BGN6S5002219',
            'enc': 'uncrypted',
            'payload': {'timestamp': datetime.datetime(2025, 10, 27, 20, 2, 2),
                        'data_list': [{'data_type': 'warnings',
                                        'data_content': {'max_warning_level': 3,
                                                        'general_warnings': {'temp_differentce_warning': 1,
                                                                            'pack_high_temp_warning': 1,
                                                                            'pack_over_volt_warning': 0,
                                                                            'pack_under_volt_warning': 0,
                                                                            'soc_low_warning': 0,
                                                                            'cell_over_volt_warning': 0,
                                                                            'cell_under_volt_warning': 0,
                                                                            'soc_high_warning': 0,
                                                                            'soc_jump_warning': 0,
                                                                            'pack_unmatched_warning': 0,
                                                                            'cell_poor_consistency_warning': 0,
                                                                            'insulation_warning': 0,
                                                                            'dcdc_temp_warning': 0,
                                                                            'brake_system_wanring': 0,
                                                                            'dcdc_state_warning': 0,
                                                                            'emotor_driver_temp_warning': 0,
                                                                            'hv_interlock_warning': 0,
                                                                            'emotor_temp_warning': 0,
                                                                            'pack_over_charged_warning': 0,
                                                                            'emotor_over_speed_warning': 0,
                                                                            'emotor_over_curr_warning': 0,
                                                                            'super_capacitor_over_temp_warning': 0,
                                                                            'super_capacitor_over_pressure_warning': 0,
                                                                            'pack_thermal_event_warning': 0,
                                                                            'hydrogen_leakage_warning': 0,
                                                                            'hydrogen_system_presure_abnormal_warning': 0,
                                                                            'hydrogen_system_temp_abnormal_warning': 0,
                                                                            'fuel_cell_stack_over_temp_warning': 0},
                                                        'pack_failures': [],
                                                        'emotor_failures': [],
                                                        'engine_failures': [],
                                                        'other_failures': ['00010003',
                                                                            '00080002',
                                                                            '00080003',
                                                                            '000c0004',
                                                                            '000d0001',
                                                                            '00060920',
                                                                            '000a000b'],
                                                        'general_warning_list': [{'warning': 'temp_differentce_warning',
                                                                                'level': 2},
                                                                                {'warning': 'pack_high_temp_warning',
                                                                                'level': 3}]}},
                                    {'data_type': 'warnings',
                                        'data_content': {'max_warning_level': 3,
                                                        'general_warnings': {'temp_differentce_warning': 1,
                                                                            'pack_high_temp_warning': 1,
                                                                            'pack_over_volt_warning': 0,
                                                                            'pack_under_volt_warning': 0,
                                                                            'soc_low_warning': 0,
                                                                            'cell_over_volt_warning': 0,
                                                                            'cell_under_volt_warning': 0,
                                                                            'soc_high_warning': 0,
                                                                            'soc_jump_warning': 0,
                                                                            'pack_unmatched_warning': 0,
                                                                            'cell_poor_consistency_warning': 0,
                                                                            'insulation_warning': 0,
                                                                            'dcdc_temp_warning': 0,
                                                                            'brake_system_wanring': 0,
                                                                            'dcdc_state_warning': 0,
                                                                            'emotor_driver_temp_warning': 0,
                                                                            'hv_interlock_warning': 0,
                                                                            'emotor_temp_warning': 0,
                                                                            'pack_over_charged_warning': 0,
                                                                            'emotor_over_speed_warning': 0,
                                                                            'emotor_over_curr_warning': 0,
                                                                            'super_capacitor_over_temp_warning': 0,
                                                                            'super_capacitor_over_pressure_warning': 0,
                                                                            'pack_thermal_event_warning': 0,
                                                                            'hydrogen_leakage_warning': 0,
                                                                            'hydrogen_system_presure_abnormal_warning': 0,
                                                                            'hydrogen_system_temp_abnormal_warning': 0,
                                                                            'fuel_cell_stack_over_temp_warning': 0},
                                                        'pack_failures': [],
                                                        'emotor_failures': [],
                                                        'engine_failures': [],
                                                        'other_failures': ['00010003',
                                                                            '00080002',
                                                                            '00080003',
                                                                            '000c0004',
                                                                            '000d0001',
                                                                            '00060920',
                                                                            '000a000b'],
                                                        'general_warning_list': [{'warning': 'soc_low_warning',
                                                                                'level': 2},
                                                                                {'warning': 'pack_high_temp_warning',
                                                                                'level': 3}]}}],
                        'sig_starter': 'ff',
                        'sig': {'algo': 'sm2',
                                'r_len': 3,
                                'r_value': 'aabbcc',
                                's_len': 4,
                                's_value': 'aabbccdd'}},
            'checksum': 133}
        ),
    ))

def test_msg_weird_data2():
    check_data((
        # Weird message with addtional unknown data before checksum
        ("242402fe484155563442474e365335303032323139010323190a1c0e2d2f010103010000000261061be275464b011f199902020103477d0000030d404a0203497d0000030d3b45050102000000000000000006000000000000000003000800020009002500090026000701011be2754600b40f750f780f760f790f770f760f790f7a0f7a0f7c0f7b0f7c0f7d0f7d0f7d0f7a0f7a0f7a0f7b0f7a0f7b0f7b0f7c0f7d0f7c0f7c0f7e0f7c0f7c0f7a0f7b0f7b0f7d0f7b0f7d0f7d0f7d0f7d0f7d0f7c0f7d0f7c0f7c0f7c0f7d0f790f780f760f7c0f7b0f7c0f7c0f7c0f7c0f7c0f770f7d0f780f7d0f7c0f7c0f7d0f7a0f7f0f7a0f7d0f7c0f7b0f7c0f7c0f7d0f7c0f7c0f7f0f7d0f7d0f7e0f7d0f7d0f7e0f7d0f7e0f7e0f7d0f7d0f7d0f7d0f7d0f7e0f7e0f7b0f7c0f7c0f7c0f7b0f7b0f780f7c0f7d0f7a0f7c0f7c0f7c0f7c0f7c0f7c0f7d0f7a0f7b0f7a0f7a0f7c0f7d0f7c0f7d0f7d0f7c0f7c0f7b0f7d0f790f7c0f7b0f7a0f7c0f7c0f7c0f7b0f7c0f7d0f7b0f7d0f7c0f7c0f7c0f790f7c0f7c0f7b0f7c0f7a0f7d0f7b0f7b0f7c0f7c0f7c0f7d0f7b0f7b0f7a0f7c0f7b0f7c0f7c0f7d0f7c0f7b0f7b0f7c0f7b0f7c0f7c0f7c0f7c0f7b0f7c0f7c0f7d0f7c0f7c0f7c0f7c0f7c0f7c0f7d0f7d0f7d0f7d0f7d0801010030464646454646464645444545464645444646464646464646464746464646464645444646444544434546454545454645ff0201002825085f0b2c0a294d47f6a8a738032f20bd7e5ede663a893c6c159f27e9154b7ac2d83e2fcbff21891237d29771e7c1f89552cc4eb82d480b291f5d253cc824908da0ee55ecd28a357fbb8013d7b371b4e0ac01061d34403871e645952c4d06d2fa25f374291af07f83e7b0e0d34fa29c5107866ca4561dfbcd2b72e04de52cfd5bbb6d66575189dc133db02cce0ef55ee2daab8d6de8d96e154e99f0cebeb0ecdc54e83aab694ae451e687b848735b0c6db777d63483c3c849fe2d2a39f895e6277670fd4ef586ea0cc65bfb6ace7a7be95ae695977f3377ea6b2187eae74ca021afc2646266af61a850695e441a4bbf6b807f1345897b38d86a8e90c1ed350000820023000004190104230103dd0103f70100010001000100010101000105db0100ffffff0101e7",
            {'starter': 'protocol_2025',
            'msg_type': 'realtime',
            'ack': 'command',
            'vin': 'HAUV4BGN6S5002219',
            'enc': 'uncrypted',
            'payload': {'timestamp': datetime.datetime(2025, 10, 28, 14, 45, 47),
                        'data_list': [{'data_type': 'whole_vehicle',
                                        'data_content': {'vehicle_state': 'on',
                                                        'charge_state': 'uncharged',
                                                        'operate_state': 'pure_electric',
                                                        'vehicle_speed': '0.0 km/h',
                                                        'mileage_total': '15591.0 km',
                                                        'voltage_total': '713.8000000000001 '
                                                                        'V',
                                                        'current_total': '2.200000000000273 '
                                                                        'A',
                                                        'soc': '75 %',
                                                        'dcdc_state': 'on',
                                                        'gear_state': {'gear_postion_validity': 'valid',
                                                                        'driving_force': 0,
                                                                        'braking_force': 1,
                                                                        'gear': 'P'},
                                                        'insulation_resistance': '6553 '
                                                                                'kΩ'}},
                                    {'data_type': 'emotor',
                                        'data_content': [{'index': 1,
                                                        'state': 'off',
                                                        'ctrl_temp': '31 ℃',
                                                        'speed': '0 rpm',
                                                        'torque': '0.0 N·m',
                                                        'temp': '34 ℃'},
                                                        {'index': 2,
                                                        'state': 'off',
                                                        'ctrl_temp': '33 ℃',
                                                        'speed': '0 rpm',
                                                        'torque': '-0.5 N·m',
                                                        'temp': '29 ℃'}]},
                                    {'data_type': 'gnss',
                                        'data_content': {'gnss_state': {'gnss_e_w': 'e',
                                                                        'gnss_n_s': 'n',
                                                                        'gnss_valid': 1},
                                                        'gnss_gcs': 'gcj02',
                                                        'gnss_lng': '0.0 °',
                                                        'gnss_lat': '0.0 °'}},
                                    {'data_type': 'warnings',
                                        'data_content': {'max_warning_level': 0,
                                                        'general_warnings': {'temp_differentce_warning': 0,
                                                                            'pack_high_temp_warning': 0,
                                                                            'pack_over_volt_warning': 0,
                                                                            'pack_under_volt_warning': 0,
                                                                            'soc_low_warning': 0,
                                                                            'cell_over_volt_warning': 0,
                                                                            'cell_under_volt_warning': 0,
                                                                            'soc_high_warning': 0,
                                                                            'soc_jump_warning': 0,
                                                                            'pack_unmatched_warning': 0,
                                                                            'cell_poor_consistency_warning': 0,
                                                                            'insulation_warning': 0,
                                                                            'dcdc_temp_warning': 0,
                                                                            'brake_system_wanring': 0,
                                                                            'dcdc_state_warning': 0,
                                                                            'emotor_driver_temp_warning': 0,
                                                                            'hv_interlock_warning': 0,
                                                                            'emotor_temp_warning': 0,
                                                                            'pack_over_charged_warning': 0,
                                                                            'emotor_over_speed_warning': 0,
                                                                            'emotor_over_curr_warning': 0,
                                                                            'super_capacitor_over_temp_warning': 0,
                                                                            'super_capacitor_over_pressure_warning': 0,
                                                                            'pack_thermal_event_warning': 0,
                                                                            'hydrogen_leakage_warning': 0,
                                                                            'hydrogen_system_presure_abnormal_warning': 0,
                                                                            'hydrogen_system_temp_abnormal_warning': 0,
                                                                            'fuel_cell_stack_over_temp_warning': 0},
                                                        'pack_failures': [],
                                                        'emotor_failures': [],
                                                        'engine_failures': [],
                                                        'other_failures': ['00080002',
                                                                            '00090025',
                                                                            '00090026'],
                                                        'general_warning_list': []}},
                                    {'data_type': 'cell_volts',
                                        'data_content': [{'index': '1',
                                                        'volt': '713.8000000000001 V',
                                                        'curr': '2.200000000000273 V',
                                                        'cell_volts': ['3.9570000000000003 '
                                                                        'V',
                                                                        '3.96 V',
                                                                        '3.958 V',
                                                                        '3.9610000000000003 '
                                                                        'V',
                                                                        '3.959 V',
                                                                        '3.958 V',
                                                                        '3.9610000000000003 '
                                                                        'V',
                                                                        '3.962 V',
                                                                        '3.962 V',
                                                                        '3.964 V',
                                                                        '3.963 V',
                                                                        '3.964 V',
                                                                        '3.9650000000000003 '
                                                                        'V',
                                                                        '3.9650000000000003 '
                                                                        'V',
                                                                        '3.9650000000000003 '
                                                                        'V',
                                                                        '3.962 V',
                                                                        '3.962 V',
                                                                        '3.962 V',
                                                                        '3.963 V',
                                                                        '3.962 V',
                                                                        '3.963 V',
                                                                        '3.963 V',
                                                                        '3.964 V',
                                                                        '3.9650000000000003 '
                                                                        'V',
                                                                        '3.964 V',
                                                                        '3.964 V',
                                                                        '3.966 V',
                                                                        '3.964 V',
                                                                        '3.964 V',
                                                                        '3.962 V',
                                                                        '3.963 V',
                                                                        '3.963 V',
                                                                        '3.9650000000000003 '
                                                                        'V',
                                                                        '3.963 V',
                                                                        '3.9650000000000003 '
                                                                        'V',
                                                                        '3.9650000000000003 '
                                                                        'V',
                                                                        '3.9650000000000003 '
                                                                        'V',
                                                                        '3.9650000000000003 '
                                                                        'V',
                                                                        '3.9650000000000003 '
                                                                        'V',
                                                                        '3.964 V',
                                                                        '3.9650000000000003 '
                                                                        'V',
                                                                        '3.964 V',
                                                                        '3.964 V',
                                                                        '3.964 V',
                                                                        '3.9650000000000003 '
                                                                        'V',
                                                                        '3.9610000000000003 '
                                                                        'V',
                                                                        '3.96 V',
                                                                        '3.958 V',
                                                                        '3.964 V',
                                                                        '3.963 V',
                                                                        '3.964 V',
                                                                        '3.964 V',
                                                                        '3.964 V',
                                                                        '3.964 V',
                                                                        '3.964 V',
                                                                        '3.959 V',
                                                                        '3.9650000000000003 '
                                                                        'V',
                                                                        '3.96 V',
                                                                        '3.9650000000000003 '
                                                                        'V',
                                                                        '3.964 V',
                                                                        '3.964 V',
                                                                        '3.9650000000000003 '
                                                                        'V',
                                                                        '3.962 V',
                                                                        '3.967 V',
                                                                        '3.962 V',
                                                                        '3.9650000000000003 '
                                                                        'V',
                                                                        '3.964 V',
                                                                        '3.963 V',
                                                                        '3.964 V',
                                                                        '3.964 V',
                                                                        '3.9650000000000003 '
                                                                        'V',
                                                                        '3.964 V',
                                                                        '3.964 V',
                                                                        '3.967 V',
                                                                        '3.9650000000000003 '
                                                                        'V',
                                                                        '3.9650000000000003 '
                                                                        'V',
                                                                        '3.966 V',
                                                                        '3.9650000000000003 '
                                                                        'V',
                                                                        '3.9650000000000003 '
                                                                        'V',
                                                                        '3.966 V',
                                                                        '3.9650000000000003 '
                                                                        'V',
                                                                        '3.966 V',
                                                                        '3.966 V',
                                                                        '3.9650000000000003 '
                                                                        'V',
                                                                        '3.9650000000000003 '
                                                                        'V',
                                                                        '3.9650000000000003 '
                                                                        'V',
                                                                        '3.9650000000000003 '
                                                                        'V',
                                                                        '3.9650000000000003 '
                                                                        'V',
                                                                        '3.966 V',
                                                                        '3.966 V',
                                                                        '3.963 V',
                                                                        '3.964 V',
                                                                        '3.964 V',
                                                                        '3.964 V',
                                                                        '3.963 V',
                                                                        '3.963 V',
                                                                        '3.96 V',
                                                                        '3.964 V',
                                                                        '3.9650000000000003 '
                                                                        'V',
                                                                        '3.962 V',
                                                                        '3.964 V',
                                                                        '3.964 V',
                                                                        '3.964 V',
                                                                        '3.964 V',
                                                                        '3.964 V',
                                                                        '3.964 V',
                                                                        '3.9650000000000003 '
                                                                        'V',
                                                                        '3.962 V',
                                                                        '3.963 V',
                                                                        '3.962 V',
                                                                        '3.962 V',
                                                                        '3.964 V',
                                                                        '3.9650000000000003 '
                                                                        'V',
                                                                        '3.964 V',
                                                                        '3.9650000000000003 '
                                                                        'V',
                                                                        '3.9650000000000003 '
                                                                        'V',
                                                                        '3.964 V',
                                                                        '3.964 V',
                                                                        '3.963 V',
                                                                        '3.9650000000000003 '
                                                                        'V',
                                                                        '3.9610000000000003 '
                                                                        'V',
                                                                        '3.964 V',
                                                                        '3.963 V',
                                                                        '3.962 V',
                                                                        '3.964 V',
                                                                        '3.964 V',
                                                                        '3.964 V',
                                                                        '3.963 V',
                                                                        '3.964 V',
                                                                        '3.9650000000000003 '
                                                                        'V',
                                                                        '3.963 V',
                                                                        '3.9650000000000003 '
                                                                        'V',
                                                                        '3.964 V',
                                                                        '3.964 V',
                                                                        '3.964 V',
                                                                        '3.9610000000000003 '
                                                                        'V',
                                                                        '3.964 V',
                                                                        '3.964 V',
                                                                        '3.963 V',
                                                                        '3.964 V',
                                                                        '3.962 V',
                                                                        '3.9650000000000003 '
                                                                        'V',
                                                                        '3.963 V',
                                                                        '3.963 V',
                                                                        '3.964 V',
                                                                        '3.964 V',
                                                                        '3.964 V',
                                                                        '3.9650000000000003 '
                                                                        'V',
                                                                        '3.963 V',
                                                                        '3.963 V',
                                                                        '3.962 V',
                                                                        '3.964 V',
                                                                        '3.963 V',
                                                                        '3.964 V',
                                                                        '3.964 V',
                                                                        '3.9650000000000003 '
                                                                        'V',
                                                                        '3.964 V',
                                                                        '3.963 V',
                                                                        '3.963 V',
                                                                        '3.964 V',
                                                                        '3.963 V',
                                                                        '3.964 V',
                                                                        '3.964 V',
                                                                        '3.964 V',
                                                                        '3.964 V',
                                                                        '3.963 V',
                                                                        '3.964 V',
                                                                        '3.964 V',
                                                                        '3.9650000000000003 '
                                                                        'V',
                                                                        '3.964 V',
                                                                        '3.964 V',
                                                                        '3.964 V',
                                                                        '3.964 V',
                                                                        '3.964 V',
                                                                        '3.964 V',
                                                                        '3.9650000000000003 '
                                                                        'V',
                                                                        '3.9650000000000003 '
                                                                        'V',
                                                                        '3.9650000000000003 '
                                                                        'V',
                                                                        '3.9650000000000003 '
                                                                        'V',
                                                                        '3.9650000000000003 '
                                                                        'V']}]},
                                    {'data_type': 'probe_temps',
                                        'data_content': [{'index': '1',
                                                        'probe_temps': ['30 ℃',
                                                                        '30 ℃',
                                                                        '30 ℃',
                                                                        '29 ℃',
                                                                        '30 ℃',
                                                                        '30 ℃',
                                                                        '30 ℃',
                                                                        '30 ℃',
                                                                        '29 ℃',
                                                                        '28 ℃',
                                                                        '29 ℃',
                                                                        '29 ℃',
                                                                        '30 ℃',
                                                                        '30 ℃',
                                                                        '29 ℃',
                                                                        '28 ℃',
                                                                        '30 ℃',
                                                                        '30 ℃',
                                                                        '30 ℃',
                                                                        '30 ℃',
                                                                        '30 ℃',
                                                                        '30 ℃',
                                                                        '30 ℃',
                                                                        '30 ℃',
                                                                        '30 ℃',
                                                                        '31 ℃',
                                                                        '30 ℃',
                                                                        '30 ℃',
                                                                        '30 ℃',
                                                                        '30 ℃',
                                                                        '30 ℃',
                                                                        '30 ℃',
                                                                        '29 ℃',
                                                                        '28 ℃',
                                                                        '30 ℃',
                                                                        '30 ℃',
                                                                        '28 ℃',
                                                                        '29 ℃',
                                                                        '28 ℃',
                                                                        '27 ℃',
                                                                        '29 ℃',
                                                                        '30 ℃',
                                                                        '29 ℃',
                                                                        '29 ℃',
                                                                        '29 ℃',
                                                                        '29 ℃',
                                                                        '30 ℃',
                                                                        '29 ℃']}]}],
                        'sig_starter': 'ff',
                        'sig': {'algo': 'rsa',
                                'r_len': 256,
                                'r_value': '2825085f0b2c0a294d47f6a8a738032f20bd7e5ede663a893c6c159f27e9154b7ac2d83e2fcbff21891237d29771e7c1f89552cc4eb82d480b291f5d253cc824908da0ee55ecd28a357fbb8013d7b371b4e0ac01061d34403871e645952c4d06d2fa25f374291af07f83e7b0e0d34fa29c5107866ca4561dfbcd2b72e04de52cfd5bbb6d66575189dc133db02cce0ef55ee2daab8d6de8d96e154e99f0cebeb0ecdc54e83aab694ae451e687b848735b0c6db777d63483c3c849fe2d2a39f895e6277670fd4ef586ea0cc65bfb6ace7a7be95ae695977f3377ea6b2187eae74ca021afc2646266af61a850695e441a4bbf6b807f1345897b38d86a8e90c1ed35',
                                's_len': 0,
                                's_value': ''}},
            'checksum': 231}
        ),
    ), check_build=False)
def test_msg_weird_data3():
    check_data((
        # Weird message with addtional unknown data before signature
        ("242402fe484155563442474e36533530303232313901031e190a1c0e2d2f010103010000000261061be275464b011f199902020103477d0000030d404a0203497d0000030d3b45050102000000000000000006000000000000000003000800020009002500090026000701011be2754600b40f750f780f760f790f770f760f790f7a0f7a0f7c0f7b0f7c0f7d0f7d0f7d0f7a0f7a0f7a0f7b0f7a0f7b0f7b0f7c0f7d0f7c0f7c0f7e0f7c0f7c0f7a0f7b0f7b0f7d0f7b0f7d0f7d0f7d0f7d0f7d0f7c0f7d0f7c0f7c0f7c0f7d0f790f780f760f7c0f7b0f7c0f7c0f7c0f7c0f7c0f770f7d0f780f7d0f7c0f7c0f7d0f7a0f7f0f7a0f7d0f7c0f7b0f7c0f7c0f7d0f7c0f7c0f7f0f7d0f7d0f7e0f7d0f7d0f7e0f7d0f7e0f7e0f7d0f7d0f7d0f7d0f7d0f7e0f7e0f7b0f7c0f7c0f7c0f7b0f7b0f780f7c0f7d0f7a0f7c0f7c0f7c0f7c0f7c0f7c0f7d0f7a0f7b0f7a0f7a0f7c0f7d0f7c0f7d0f7d0f7c0f7c0f7b0f7d0f790f7c0f7b0f7a0f7c0f7c0f7c0f7b0f7c0f7d0f7b0f7d0f7c0f7c0f7c0f790f7c0f7c0f7b0f7c0f7a0f7d0f7b0f7b0f7c0f7c0f7c0f7d0f7b0f7b0f7a0f7c0f7b0f7c0f7c0f7d0f7c0f7b0f7b0f7c0f7b0f7c0f7c0f7c0f7c0f7b0f7c0f7c0f7d0f7c0f7c0f7c0f7c0f7c0f7c0f7d0f7d0f7d0f7d0f7d0801010030464646454646464645444545464645444646464646464646464746464646464645444646444544434546454545454645790023000004190104230103dd0103f70100010001000100010101000105db0100ff0201002825085f0b2c0a294d47f6a8a738032f20bd7e5ede663a893c6c159f27e9154b7ac2d83e2fcbff21891237d29771e7c1f89552cc4eb82d480b291f5d253cc824908da0ee55ecd28a357fbb8013d7b371b4e0ac01061d34403871e645952c4d06d2fa25f374291af07f83e7b0e0d34fa29c5107866ca4561dfbcd2b72e04de52cfd5bbb6d66575189dc133db02cce0ef55ee2daab8d6de8d96e154e99f0cebeb0ecdc54e83aab694ae451e687b848735b0c6db777d63483c3c849fe2d2a39f895e6277670fd4ef586ea0cc65bfb6ace7a7be95ae695977f3377ea6b2187eae74ca021afc2646266af61a850695e441a4bbf6b807f1345897b38d86a8e90c1ed350000de",
            {'starter': 'protocol_2025',
            'msg_type': 'realtime',
            'ack': 'command',
            'vin': 'HAUV4BGN6S5002219',
            'enc': 'uncrypted',
            'payload': {'timestamp': datetime.datetime(2025, 10, 28, 14, 45, 47),
                        'data_list': [{'data_type': 'whole_vehicle',
                                        'data_content': {'vehicle_state': 'on',
                                                        'charge_state': 'uncharged',
                                                        'operate_state': 'pure_electric',
                                                        'vehicle_speed': '0.0 km/h',
                                                        'mileage_total': '15591.0 km',
                                                        'voltage_total': '713.8000000000001 '
                                                                        'V',
                                                        'current_total': '2.200000000000273 '
                                                                        'A',
                                                        'soc': '75 %',
                                                        'dcdc_state': 'on',
                                                        'gear_state': {'gear_postion_validity': 'valid',
                                                                        'driving_force': 0,
                                                                        'braking_force': 1,
                                                                        'gear': 'P'},
                                                        'insulation_resistance': '6553 '
                                                                                'kΩ'}},
                                    {'data_type': 'emotor',
                                        'data_content': [{'index': 1,
                                                        'state': 'off',
                                                        'ctrl_temp': '31 ℃',
                                                        'speed': '0 rpm',
                                                        'torque': '0.0 N·m',
                                                        'temp': '34 ℃'},
                                                        {'index': 2,
                                                        'state': 'off',
                                                        'ctrl_temp': '33 ℃',
                                                        'speed': '0 rpm',
                                                        'torque': '-0.5 N·m',
                                                        'temp': '29 ℃'}]},
                                    {'data_type': 'gnss',
                                        'data_content': {'gnss_state': {'gnss_e_w': 'e',
                                                                        'gnss_n_s': 'n',
                                                                        'gnss_valid': 1},
                                                        'gnss_gcs': 'gcj02',
                                                        'gnss_lng': '0.0 °',
                                                        'gnss_lat': '0.0 °'}},
                                    {'data_type': 'warnings',
                                        'data_content': {'max_warning_level': 0,
                                                        'general_warnings': {'temp_differentce_warning': 0,
                                                                            'pack_high_temp_warning': 0,
                                                                            'pack_over_volt_warning': 0,
                                                                            'pack_under_volt_warning': 0,
                                                                            'soc_low_warning': 0,
                                                                            'cell_over_volt_warning': 0,
                                                                            'cell_under_volt_warning': 0,
                                                                            'soc_high_warning': 0,
                                                                            'soc_jump_warning': 0,
                                                                            'pack_unmatched_warning': 0,
                                                                            'cell_poor_consistency_warning': 0,
                                                                            'insulation_warning': 0,
                                                                            'dcdc_temp_warning': 0,
                                                                            'brake_system_wanring': 0,
                                                                            'dcdc_state_warning': 0,
                                                                            'emotor_driver_temp_warning': 0,
                                                                            'hv_interlock_warning': 0,
                                                                            'emotor_temp_warning': 0,
                                                                            'pack_over_charged_warning': 0,
                                                                            'emotor_over_speed_warning': 0,
                                                                            'emotor_over_curr_warning': 0,
                                                                            'super_capacitor_over_temp_warning': 0,
                                                                            'super_capacitor_over_pressure_warning': 0,
                                                                            'pack_thermal_event_warning': 0,
                                                                            'hydrogen_leakage_warning': 0,
                                                                            'hydrogen_system_presure_abnormal_warning': 0,
                                                                            'hydrogen_system_temp_abnormal_warning': 0,
                                                                            'fuel_cell_stack_over_temp_warning': 0},
                                                        'pack_failures': [],
                                                        'emotor_failures': [],
                                                        'engine_failures': [],
                                                        'other_failures': ['00080002',
                                                                            '00090025',
                                                                            '00090026'],
                                                        'general_warning_list': []}},
                                    {'data_type': 'cell_volts',
                                        'data_content': [{'index': '1',
                                                        'volt': '713.8000000000001 V',
                                                        'curr': '2.200000000000273 V',
                                                        'cell_volts': ['3.9570000000000003 '
                                                                        'V',
                                                                        '3.96 V',
                                                                        '3.958 V',
                                                                        '3.9610000000000003 '
                                                                        'V',
                                                                        '3.959 V',
                                                                        '3.958 V',
                                                                        '3.9610000000000003 '
                                                                        'V',
                                                                        '3.962 V',
                                                                        '3.962 V',
                                                                        '3.964 V',
                                                                        '3.963 V',
                                                                        '3.964 V',
                                                                        '3.9650000000000003 '
                                                                        'V',
                                                                        '3.9650000000000003 '
                                                                        'V',
                                                                        '3.9650000000000003 '
                                                                        'V',
                                                                        '3.962 V',
                                                                        '3.962 V',
                                                                        '3.962 V',
                                                                        '3.963 V',
                                                                        '3.962 V',
                                                                        '3.963 V',
                                                                        '3.963 V',
                                                                        '3.964 V',
                                                                        '3.9650000000000003 '
                                                                        'V',
                                                                        '3.964 V',
                                                                        '3.964 V',
                                                                        '3.966 V',
                                                                        '3.964 V',
                                                                        '3.964 V',
                                                                        '3.962 V',
                                                                        '3.963 V',
                                                                        '3.963 V',
                                                                        '3.9650000000000003 '
                                                                        'V',
                                                                        '3.963 V',
                                                                        '3.9650000000000003 '
                                                                        'V',
                                                                        '3.9650000000000003 '
                                                                        'V',
                                                                        '3.9650000000000003 '
                                                                        'V',
                                                                        '3.9650000000000003 '
                                                                        'V',
                                                                        '3.9650000000000003 '
                                                                        'V',
                                                                        '3.964 V',
                                                                        '3.9650000000000003 '
                                                                        'V',
                                                                        '3.964 V',
                                                                        '3.964 V',
                                                                        '3.964 V',
                                                                        '3.9650000000000003 '
                                                                        'V',
                                                                        '3.9610000000000003 '
                                                                        'V',
                                                                        '3.96 V',
                                                                        '3.958 V',
                                                                        '3.964 V',
                                                                        '3.963 V',
                                                                        '3.964 V',
                                                                        '3.964 V',
                                                                        '3.964 V',
                                                                        '3.964 V',
                                                                        '3.964 V',
                                                                        '3.959 V',
                                                                        '3.9650000000000003 '
                                                                        'V',
                                                                        '3.96 V',
                                                                        '3.9650000000000003 '
                                                                        'V',
                                                                        '3.964 V',
                                                                        '3.964 V',
                                                                        '3.9650000000000003 '
                                                                        'V',
                                                                        '3.962 V',
                                                                        '3.967 V',
                                                                        '3.962 V',
                                                                        '3.9650000000000003 '
                                                                        'V',
                                                                        '3.964 V',
                                                                        '3.963 V',
                                                                        '3.964 V',
                                                                        '3.964 V',
                                                                        '3.9650000000000003 '
                                                                        'V',
                                                                        '3.964 V',
                                                                        '3.964 V',
                                                                        '3.967 V',
                                                                        '3.9650000000000003 '
                                                                        'V',
                                                                        '3.9650000000000003 '
                                                                        'V',
                                                                        '3.966 V',
                                                                        '3.9650000000000003 '
                                                                        'V',
                                                                        '3.9650000000000003 '
                                                                        'V',
                                                                        '3.966 V',
                                                                        '3.9650000000000003 '
                                                                        'V',
                                                                        '3.966 V',
                                                                        '3.966 V',
                                                                        '3.9650000000000003 '
                                                                        'V',
                                                                        '3.9650000000000003 '
                                                                        'V',
                                                                        '3.9650000000000003 '
                                                                        'V',
                                                                        '3.9650000000000003 '
                                                                        'V',
                                                                        '3.9650000000000003 '
                                                                        'V',
                                                                        '3.966 V',
                                                                        '3.966 V',
                                                                        '3.963 V',
                                                                        '3.964 V',
                                                                        '3.964 V',
                                                                        '3.964 V',
                                                                        '3.963 V',
                                                                        '3.963 V',
                                                                        '3.96 V',
                                                                        '3.964 V',
                                                                        '3.9650000000000003 '
                                                                        'V',
                                                                        '3.962 V',
                                                                        '3.964 V',
                                                                        '3.964 V',
                                                                        '3.964 V',
                                                                        '3.964 V',
                                                                        '3.964 V',
                                                                        '3.964 V',
                                                                        '3.9650000000000003 '
                                                                        'V',
                                                                        '3.962 V',
                                                                        '3.963 V',
                                                                        '3.962 V',
                                                                        '3.962 V',
                                                                        '3.964 V',
                                                                        '3.9650000000000003 '
                                                                        'V',
                                                                        '3.964 V',
                                                                        '3.9650000000000003 '
                                                                        'V',
                                                                        '3.9650000000000003 '
                                                                        'V',
                                                                        '3.964 V',
                                                                        '3.964 V',
                                                                        '3.963 V',
                                                                        '3.9650000000000003 '
                                                                        'V',
                                                                        '3.9610000000000003 '
                                                                        'V',
                                                                        '3.964 V',
                                                                        '3.963 V',
                                                                        '3.962 V',
                                                                        '3.964 V',
                                                                        '3.964 V',
                                                                        '3.964 V',
                                                                        '3.963 V',
                                                                        '3.964 V',
                                                                        '3.9650000000000003 '
                                                                        'V',
                                                                        '3.963 V',
                                                                        '3.9650000000000003 '
                                                                        'V',
                                                                        '3.964 V',
                                                                        '3.964 V',
                                                                        '3.964 V',
                                                                        '3.9610000000000003 '
                                                                        'V',
                                                                        '3.964 V',
                                                                        '3.964 V',
                                                                        '3.963 V',
                                                                        '3.964 V',
                                                                        '3.962 V',
                                                                        '3.9650000000000003 '
                                                                        'V',
                                                                        '3.963 V',
                                                                        '3.963 V',
                                                                        '3.964 V',
                                                                        '3.964 V',
                                                                        '3.964 V',
                                                                        '3.9650000000000003 '
                                                                        'V',
                                                                        '3.963 V',
                                                                        '3.963 V',
                                                                        '3.962 V',
                                                                        '3.964 V',
                                                                        '3.963 V',
                                                                        '3.964 V',
                                                                        '3.964 V',
                                                                        '3.9650000000000003 '
                                                                        'V',
                                                                        '3.964 V',
                                                                        '3.963 V',
                                                                        '3.963 V',
                                                                        '3.964 V',
                                                                        '3.963 V',
                                                                        '3.964 V',
                                                                        '3.964 V',
                                                                        '3.964 V',
                                                                        '3.964 V',
                                                                        '3.963 V',
                                                                        '3.964 V',
                                                                        '3.964 V',
                                                                        '3.9650000000000003 '
                                                                        'V',
                                                                        '3.964 V',
                                                                        '3.964 V',
                                                                        '3.964 V',
                                                                        '3.964 V',
                                                                        '3.964 V',
                                                                        '3.964 V',
                                                                        '3.9650000000000003 '
                                                                        'V',
                                                                        '3.9650000000000003 '
                                                                        'V',
                                                                        '3.9650000000000003 '
                                                                        'V',
                                                                        '3.9650000000000003 '
                                                                        'V',
                                                                        '3.9650000000000003 '
                                                                        'V']}]},
                                    {'data_type': 'probe_temps',
                                        'data_content': [{'index': '1',
                                                        'probe_temps': ['30 ℃',
                                                                        '30 ℃',
                                                                        '30 ℃',
                                                                        '29 ℃',
                                                                        '30 ℃',
                                                                        '30 ℃',
                                                                        '30 ℃',
                                                                        '30 ℃',
                                                                        '29 ℃',
                                                                        '28 ℃',
                                                                        '29 ℃',
                                                                        '29 ℃',
                                                                        '30 ℃',
                                                                        '30 ℃',
                                                                        '29 ℃',
                                                                        '28 ℃',
                                                                        '30 ℃',
                                                                        '30 ℃',
                                                                        '30 ℃',
                                                                        '30 ℃',
                                                                        '30 ℃',
                                                                        '30 ℃',
                                                                        '30 ℃',
                                                                        '30 ℃',
                                                                        '30 ℃',
                                                                        '31 ℃',
                                                                        '30 ℃',
                                                                        '30 ℃',
                                                                        '30 ℃',
                                                                        '30 ℃',
                                                                        '30 ℃',
                                                                        '30 ℃',
                                                                        '29 ℃',
                                                                        '28 ℃',
                                                                        '30 ℃',
                                                                        '30 ℃',
                                                                        '28 ℃',
                                                                        '29 ℃',
                                                                        '28 ℃',
                                                                        '27 ℃',
                                                                        '29 ℃',
                                                                        '30 ℃',
                                                                        '29 ℃',
                                                                        '29 ℃',
                                                                        '29 ℃',
                                                                        '29 ℃',
                                                                        '30 ℃',
                                                                        '29 ℃']}]},
                                    {'data_type': 121,
                                        'data_content': [{'data_byte': 0},
                                                        {'data_byte': 35},
                                                        {'data_byte': 0},
                                                        {'data_byte': 0},
                                                        {'data_byte': 4},
                                                        {'data_byte': 25},
                                                        {'data_byte': 1},
                                                        {'data_byte': 4},
                                                        {'data_byte': 35},
                                                        {'data_byte': 1},
                                                        {'data_byte': 3},
                                                        {'data_byte': 221},
                                                        {'data_byte': 1},
                                                        {'data_byte': 3},
                                                        {'data_byte': 247},
                                                        {'data_byte': 1},
                                                        {'data_byte': 0},
                                                        {'data_byte': 1},
                                                        {'data_byte': 0},
                                                        {'data_byte': 1},
                                                        {'data_byte': 0},
                                                        {'data_byte': 1},
                                                        {'data_byte': 0},
                                                        {'data_byte': 1},
                                                        {'data_byte': 1},
                                                        {'data_byte': 1},
                                                        {'data_byte': 0},
                                                        {'data_byte': 1},
                                                        {'data_byte': 5},
                                                        {'data_byte': 219},
                                                        {'data_byte': 1},
                                                        {'data_byte': 0}]}],
                        'sig_starter': 'ff',
                        'sig': {'algo': 'rsa',
                                'r_len': 256,
                                'r_value': '2825085f0b2c0a294d47f6a8a738032f20bd7e5ede663a893c6c159f27e9154b7ac2d83e2fcbff21891237d29771e7c1f89552cc4eb82d480b291f5d253cc824908da0ee55ecd28a357fbb8013d7b371b4e0ac01061d34403871e645952c4d06d2fa25f374291af07f83e7b0e0d34fa29c5107866ca4561dfbcd2b72e04de52cfd5bbb6d66575189dc133db02cce0ef55ee2daab8d6de8d96e154e99f0cebeb0ecdc54e83aab694ae451e687b848735b0c6db777d63483c3c849fe2d2a39f895e6277670fd4ef586ea0cc65bfb6ace7a7be95ae695977f3377ea6b2187eae74ca021afc2646266af61a850695e441a4bbf6b807f1345897b38d86a8e90c1ed35',
                                's_len': 0,
                                's_value': ''}},
            'checksum': 222}
        ),
    ), check_build=False)

def test_msg_data_2016():
    check_data((
        ("232302fe484155563442474e365335303032323139010239190a0b13081201010301007a00000a1d1e81274355011e19990010020201013851794e343d1e4b272402023751894cdb401e4b26f7050000000000000000000601020fdf01140fdc01013a010a38070000000000000000000801011e81274300c00001c00fdd0fdf0fde0fde0fdd0fdd0fdd0fde0fdf0fde0fdd0fdd0fde0fde0fdd0fdd0fdd0fde0fdd0fdc0fdd0fdd0fdd0fde0fdd0fde0fde0fdd0fdf0fde0fde0fdd0fdd0fdd0fde0fdd0fde0fde0fdd0fde0fde0fdd0fdd0fdd0fde0fde0fde0fdd0fdd0fde0fdc0fdc0fdd0fdd0fde0fdd0fdd0fdc0fdd0fdd0fdd0fde0fdd0fde0fde0fde0fde0fdd0fde0fdd0fdd0fdd0fde0fde0fdf0fdf0fdf0fdf0fdd0fdd0fde0fdd0fdd0fde0fde0fdf0fde0fdd0fde0fdd0fdf0fde0fdf0fdf0fdf0fdf0fde0fde0fde0fde0fdd0fde0fdd0fde0fdd0fdd0fde0fdc0fdd0fdd0fdd0fde0fdc0fde0fdd0fdd0fdd0fde0fdd0fdd0fde0fdd0fde0fdc0fde0fde0fde0fde0fde0fdc0fdc0fdd0fdd0fdd0fdd0fde0fdc0fdd0fdd0fdc0fde0fde0fde0fdd0fdd0fdf0fde0fdf0fde0fde0fde0fdf0fde0fdf0fde0fdf0fde0fdf0fde0fdf0fdd0fdd0fde0fde0fde0fde0fdd0fde0fdd0fde0fdd0fdd0fde0fde0fdd0fdd0fde0fde0fdd0fdd0fdf0fde0fdd0fde0fde0fde0fde0fde0fde0fde0fdf0fde09010100303a393a3a393939393938393939393939393a3939393a3a3a3a393a3a39393939393939393839393939393939393a3a3a83001d000007ff0107fd01047a0107fd01000100010001000101010001069a015c",
            {'starter': 'protocol_2016',
            'msg_type': 'realtime',
            'ack': 'command',
            'vin': 'HAUV4BGN6S5002219',
            'enc': 'uncrypted',
            'payload': {'timestamp': datetime.datetime(2025, 10, 11, 19, 8, 18),
                        'data_list': [{'data_type': 'whole_vehicle',
                                        'data_content': {'vehicle_state': 'on',
                                                        'charge_state': 'uncharged',
                                                        'operate_state': 'pure_electric',
                                                        'vehicle_speed': '12.200000000000001 '
                                                                        'km/h',
                                                        'mileage_total': '258.90000000000003 '
                                                                        'km',
                                                        'voltage_total': '780.9000000000001 '
                                                                        'V',
                                                        'current_total': '5.100000000000023 '
                                                                        'A',
                                                        'soc': '85 %',
                                                        'dcdc_state': 'on',
                                                        'gear_state': {'driving_force': 0,
                                                                        'braking_force': 1,
                                                                        'gear': 'D'},
                                                        'insulation_resistance': '6553 kΩ',
                                                        'accelerator_padel': '0 %',
                                                        'brake_padel': '16 %'}},
                                    {'data_type': 'emotor',
                                        'data_content': [{'index': 1,
                                                        'state': 'consuming_power',
                                                        'ctrl_temp': '16 ℃',
                                                        'speed': '857 rpm',
                                                        'torque': '2.0 N·m',
                                                        'temp': '21 ℃',
                                                        'ctrl_volt': '775.5 V',
                                                        'ctrl_curr': '2.0 A'},
                                                        {'index': 2,
                                                        'state': 'generating_power',
                                                        'ctrl_temp': '15 ℃',
                                                        'speed': '873 rpm',
                                                        'torque': '-32.5 N·m',
                                                        'temp': '24 ℃',
                                                        'ctrl_volt': '775.5 V',
                                                        'ctrl_curr': '-2.5 A'}]},
                                    {'data_type': 'gnss',
                                        'data_content': {'gnss_state': {'gnss_e_w': 'e',
                                                                        'gnss_n_s': 'n',
                                                                        'gnss_valid': 0},
                                                        'gnss_lng': '0.0 °',
                                                        'gnss_lat': '0.0 °'}},
                                    {'data_type': 'pack_extrema',
                                        'data_content': {'max_volt_pack_index': '1',
                                                        'max_volt_cell_index': '2',
                                                        'max_cell_volt': '4.063 V',
                                                        'min_volt_pack_index': '1',
                                                        'min_volt_cell_index': '20',
                                                        'min_cell_volt': '4.0600000000000005 '
                                                                        'V',
                                                        'max_temp_pack_index': '1',
                                                        'max_temp_cell_index': '1',
                                                        'max_cell_temp': '18 ℃',
                                                        'min_temp_pack_index': '1',
                                                        'min_temp_cell_index': '10',
                                                        'min_cell_temp': '16 ℃'}},
                                    {'data_type': 'warnings',
                                        'data_content': {'max_warning_level': 0,
                                                        'general_warnings': {'temp_differentce_warning': 0,
                                                                            'pack_high_temp_warning': 0,
                                                                            'pack_over_volt_warning': 0,
                                                                            'pack_under_volt_warning': 0,
                                                                            'soc_low_warning': 0,
                                                                            'cell_over_volt_warning': 0,
                                                                            'cell_under_volt_warning': 0,
                                                                            'soc_high_warning': 0,
                                                                            'soc_jump_warning': 0,
                                                                            'pack_unmatched_warning': 0,
                                                                            'cell_poor_consistency_warning': 0,
                                                                            'insulation_warning': 0,
                                                                            'dcdc_temp_warning': 0,
                                                                            'brake_system_wanring': 0,
                                                                            'dcdc_state_warning': 0,
                                                                            'emotor_driver_temp_warning': 0,
                                                                            'hv_interlock_warning': 0,
                                                                            'emotor_temp_warning': 0,
                                                                            'pack_over_charged_warning': 0},
                                                        'pack_failures': [],
                                                        'emotor_failures': [],
                                                        'engine_failures': [],
                                                        'other_failures': []}},
                                    {'data_type': 'cell_volts',
                                        'data_content': [{'index': '1',
                                                        'volt': '780.9000000000001 V',
                                                        'curr': '-1994.9 V',
                                                        'cell_total': '192',
                                                        'cell_start_index': 1,
                                                        'cell_volts': ['4.061 V',
                                                                        '4.063 V',
                                                                        '4.062 V',
                                                                        '4.062 V',
                                                                        '4.061 V',
                                                                        '4.061 V',
                                                                        '4.061 V',
                                                                        '4.062 V',
                                                                        '4.063 V',
                                                                        '4.062 V',
                                                                        '4.061 V',
                                                                        '4.061 V',
                                                                        '4.062 V',
                                                                        '4.062 V',
                                                                        '4.061 V',
                                                                        '4.061 V',
                                                                        '4.061 V',
                                                                        '4.062 V',
                                                                        '4.061 V',
                                                                        '4.0600000000000005 '
                                                                        'V',
                                                                        '4.061 V',
                                                                        '4.061 V',
                                                                        '4.061 V',
                                                                        '4.062 V',
                                                                        '4.061 V',
                                                                        '4.062 V',
                                                                        '4.062 V',
                                                                        '4.061 V',
                                                                        '4.063 V',
                                                                        '4.062 V',
                                                                        '4.062 V',
                                                                        '4.061 V',
                                                                        '4.061 V',
                                                                        '4.061 V',
                                                                        '4.062 V',
                                                                        '4.061 V',
                                                                        '4.062 V',
                                                                        '4.062 V',
                                                                        '4.061 V',
                                                                        '4.062 V',
                                                                        '4.062 V',
                                                                        '4.061 V',
                                                                        '4.061 V',
                                                                        '4.061 V',
                                                                        '4.062 V',
                                                                        '4.062 V',
                                                                        '4.062 V',
                                                                        '4.061 V',
                                                                        '4.061 V',
                                                                        '4.062 V',
                                                                        '4.0600000000000005 '
                                                                        'V',
                                                                        '4.0600000000000005 '
                                                                        'V',
                                                                        '4.061 V',
                                                                        '4.061 V',
                                                                        '4.062 V',
                                                                        '4.061 V',
                                                                        '4.061 V',
                                                                        '4.0600000000000005 '
                                                                        'V',
                                                                        '4.061 V',
                                                                        '4.061 V',
                                                                        '4.061 V',
                                                                        '4.062 V',
                                                                        '4.061 V',
                                                                        '4.062 V',
                                                                        '4.062 V',
                                                                        '4.062 V',
                                                                        '4.062 V',
                                                                        '4.061 V',
                                                                        '4.062 V',
                                                                        '4.061 V',
                                                                        '4.061 V',
                                                                        '4.061 V',
                                                                        '4.062 V',
                                                                        '4.062 V',
                                                                        '4.063 V',
                                                                        '4.063 V',
                                                                        '4.063 V',
                                                                        '4.063 V',
                                                                        '4.061 V',
                                                                        '4.061 V',
                                                                        '4.062 V',
                                                                        '4.061 V',
                                                                        '4.061 V',
                                                                        '4.062 V',
                                                                        '4.062 V',
                                                                        '4.063 V',
                                                                        '4.062 V',
                                                                        '4.061 V',
                                                                        '4.062 V',
                                                                        '4.061 V',
                                                                        '4.063 V',
                                                                        '4.062 V',
                                                                        '4.063 V',
                                                                        '4.063 V',
                                                                        '4.063 V',
                                                                        '4.063 V',
                                                                        '4.062 V',
                                                                        '4.062 V',
                                                                        '4.062 V',
                                                                        '4.062 V',
                                                                        '4.061 V',
                                                                        '4.062 V',
                                                                        '4.061 V',
                                                                        '4.062 V',
                                                                        '4.061 V',
                                                                        '4.061 V',
                                                                        '4.062 V',
                                                                        '4.0600000000000005 '
                                                                        'V',
                                                                        '4.061 V',
                                                                        '4.061 V',
                                                                        '4.061 V',
                                                                        '4.062 V',
                                                                        '4.0600000000000005 '
                                                                        'V',
                                                                        '4.062 V',
                                                                        '4.061 V',
                                                                        '4.061 V',
                                                                        '4.061 V',
                                                                        '4.062 V',
                                                                        '4.061 V',
                                                                        '4.061 V',
                                                                        '4.062 V',
                                                                        '4.061 V',
                                                                        '4.062 V',
                                                                        '4.0600000000000005 '
                                                                        'V',
                                                                        '4.062 V',
                                                                        '4.062 V',
                                                                        '4.062 V',
                                                                        '4.062 V',
                                                                        '4.062 V',
                                                                        '4.0600000000000005 '
                                                                        'V',
                                                                        '4.0600000000000005 '
                                                                        'V',
                                                                        '4.061 V',
                                                                        '4.061 V',
                                                                        '4.061 V',
                                                                        '4.061 V',
                                                                        '4.062 V',
                                                                        '4.0600000000000005 '
                                                                        'V',
                                                                        '4.061 V',
                                                                        '4.061 V',
                                                                        '4.0600000000000005 '
                                                                        'V',
                                                                        '4.062 V',
                                                                        '4.062 V',
                                                                        '4.062 V',
                                                                        '4.061 V',
                                                                        '4.061 V',
                                                                        '4.063 V',
                                                                        '4.062 V',
                                                                        '4.063 V',
                                                                        '4.062 V',
                                                                        '4.062 V',
                                                                        '4.062 V',
                                                                        '4.063 V',
                                                                        '4.062 V',
                                                                        '4.063 V',
                                                                        '4.062 V',
                                                                        '4.063 V',
                                                                        '4.062 V',
                                                                        '4.063 V',
                                                                        '4.062 V',
                                                                        '4.063 V',
                                                                        '4.061 V',
                                                                        '4.061 V',
                                                                        '4.062 V',
                                                                        '4.062 V',
                                                                        '4.062 V',
                                                                        '4.062 V',
                                                                        '4.061 V',
                                                                        '4.062 V',
                                                                        '4.061 V',
                                                                        '4.062 V',
                                                                        '4.061 V',
                                                                        '4.061 V',
                                                                        '4.062 V',
                                                                        '4.062 V',
                                                                        '4.061 V',
                                                                        '4.061 V',
                                                                        '4.062 V',
                                                                        '4.062 V',
                                                                        '4.061 V',
                                                                        '4.061 V',
                                                                        '4.063 V',
                                                                        '4.062 V',
                                                                        '4.061 V',
                                                                        '4.062 V',
                                                                        '4.062 V',
                                                                        '4.062 V',
                                                                        '4.062 V',
                                                                        '4.062 V',
                                                                        '4.062 V',
                                                                        '4.062 V',
                                                                        '4.063 V',
                                                                        '4.062 V']}]},
                                    {'data_type': 'probe_temps',
                                        'data_content': [{'index': '1',
                                                        'probe_temps': ['18 ℃',
                                                                        '17 ℃',
                                                                        '18 ℃',
                                                                        '18 ℃',
                                                                        '17 ℃',
                                                                        '17 ℃',
                                                                        '17 ℃',
                                                                        '17 ℃',
                                                                        '17 ℃',
                                                                        '16 ℃',
                                                                        '17 ℃',
                                                                        '17 ℃',
                                                                        '17 ℃',
                                                                        '17 ℃',
                                                                        '17 ℃',
                                                                        '17 ℃',
                                                                        '17 ℃',
                                                                        '18 ℃',
                                                                        '17 ℃',
                                                                        '17 ℃',
                                                                        '17 ℃',
                                                                        '18 ℃',
                                                                        '18 ℃',
                                                                        '18 ℃',
                                                                        '18 ℃',
                                                                        '17 ℃',
                                                                        '18 ℃',
                                                                        '18 ℃',
                                                                        '17 ℃',
                                                                        '17 ℃',
                                                                        '17 ℃',
                                                                        '17 ℃',
                                                                        '17 ℃',
                                                                        '17 ℃',
                                                                        '17 ℃',
                                                                        '17 ℃',
                                                                        '16 ℃',
                                                                        '17 ℃',
                                                                        '17 ℃',
                                                                        '17 ℃',
                                                                        '17 ℃',
                                                                        '17 ℃',
                                                                        '17 ℃',
                                                                        '17 ℃',
                                                                        '17 ℃',
                                                                        '18 ℃',
                                                                        '18 ℃',
                                                                        '18 ℃']}]},
                                    {'data_type': 131,
                                        'data_content': '000007ff0107fd01047a0107fd01000100010001000101010001069a01'}]},
            'checksum': 92}
        ),
    ))
def test_msg_data_2025():
    check_data((
        ("242402fe484155563442474e365335303032323139010323190a1c0e2d2f010103010000000261061be275464b011f199902020103477d0000030d404a0203497d0000030d3b45050102000000000000000006000000000000000003000800020009002500090026000701011be2754600b40f750f780f760f790f770f760f790f7a0f7a0f7c0f7b0f7c0f7d0f7d0f7d0f7a0f7a0f7a0f7b0f7a0f7b0f7b0f7c0f7d0f7c0f7c0f7e0f7c0f7c0f7a0f7b0f7b0f7d0f7b0f7d0f7d0f7d0f7d0f7d0f7c0f7d0f7c0f7c0f7c0f7d0f790f780f760f7c0f7b0f7c0f7c0f7c0f7c0f7c0f770f7d0f780f7d0f7c0f7c0f7d0f7a0f7f0f7a0f7d0f7c0f7b0f7c0f7c0f7d0f7c0f7c0f7f0f7d0f7d0f7e0f7d0f7d0f7e0f7d0f7e0f7e0f7d0f7d0f7d0f7d0f7d0f7e0f7e0f7b0f7c0f7c0f7c0f7b0f7b0f780f7c0f7d0f7a0f7c0f7c0f7c0f7c0f7c0f7c0f7d0f7a0f7b0f7a0f7a0f7c0f7d0f7c0f7d0f7d0f7c0f7c0f7b0f7d0f790f7c0f7b0f7a0f7c0f7c0f7c0f7b0f7c0f7d0f7b0f7d0f7c0f7c0f7c0f790f7c0f7c0f7b0f7c0f7a0f7d0f7b0f7b0f7c0f7c0f7c0f7d0f7b0f7b0f7a0f7c0f7b0f7c0f7c0f7d0f7c0f7b0f7b0f7c0f7b0f7c0f7c0f7c0f7c0f7b0f7c0f7c0f7d0f7c0f7c0f7c0f7c0f7c0f7c0f7d0f7d0f7d0f7d0f7d0801010030464646454646464645444545464645444646464646464646464746464646464645444646444544434546454545454645830023000004190104230103dd0103f70100010001000100010101000105db0100ffffff0101ff0201002825085f0b2c0a294d47f6a8a738032f20bd7e5ede663a893c6c159f27e9154b7ac2d83e2fcbff21891237d29771e7c1f89552cc4eb82d480b291f5d253cc824908da0ee55ecd28a357fbb8013d7b371b4e0ac01061d34403871e645952c4d06d2fa25f374291af07f83e7b0e0d34fa29c5107866ca4561dfbcd2b72e04de52cfd5bbb6d66575189dc133db02cce0ef55ee2daab8d6de8d96e154e99f0cebeb0ecdc54e83aab694ae451e687b848735b0c6db777d63483c3c849fe2d2a39f895e6277670fd4ef586ea0cc65bfb6ace7a7be95ae695977f3377ea6b2187eae74ca021afc2646266af61a850695e441a4bbf6b807f1345897b38d86a8e90c1ed350000e6",
            {'starter': 'protocol_2025',
            'msg_type': 'realtime',
            'ack': 'command',
            'vin': 'HAUV4BGN6S5002219',
            'enc': 'uncrypted',
            'payload': {'timestamp': datetime.datetime(2025, 10, 28, 14, 45, 47),
                        'data_list': [{'data_type': 'whole_vehicle',
                                        'data_content': {'vehicle_state': 'on',
                                                        'charge_state': 'uncharged',
                                                        'operate_state': 'pure_electric',
                                                        'vehicle_speed': '0.0 km/h',
                                                        'mileage_total': '15591.0 km',
                                                        'voltage_total': '713.8000000000001 '
                                                                        'V',
                                                        'current_total': '2.200000000000273 '
                                                                        'A',
                                                        'soc': '75 %',
                                                        'dcdc_state': 'on',
                                                        'gear_state': {'gear_postion_validity': 'valid',
                                                                        'driving_force': 0,
                                                                        'braking_force': 1,
                                                                        'gear': 'P'},
                                                        'insulation_resistance': '6553 '
                                                                                'kΩ'}},
                                    {'data_type': 'emotor',
                                        'data_content': [{'index': 1,
                                                        'state': 'off',
                                                        'ctrl_temp': '31 ℃',
                                                        'speed': '0 rpm',
                                                        'torque': '0.0 N·m',
                                                        'temp': '34 ℃'},
                                                        {'index': 2,
                                                        'state': 'off',
                                                        'ctrl_temp': '33 ℃',
                                                        'speed': '0 rpm',
                                                        'torque': '-0.5 N·m',
                                                        'temp': '29 ℃'}]},
                                    {'data_type': 'gnss',
                                        'data_content': {'gnss_state': {'gnss_e_w': 'e',
                                                                        'gnss_n_s': 'n',
                                                                        'gnss_valid': 1},
                                                        'gnss_gcs': 'gcj02',
                                                        'gnss_lng': '0.0 °',
                                                        'gnss_lat': '0.0 °'}},
                                    {'data_type': 'warnings',
                                        'data_content': {'max_warning_level': 0,
                                                        'general_warnings': {'temp_differentce_warning': 0,
                                                                            'pack_high_temp_warning': 0,
                                                                            'pack_over_volt_warning': 0,
                                                                            'pack_under_volt_warning': 0,
                                                                            'soc_low_warning': 0,
                                                                            'cell_over_volt_warning': 0,
                                                                            'cell_under_volt_warning': 0,
                                                                            'soc_high_warning': 0,
                                                                            'soc_jump_warning': 0,
                                                                            'pack_unmatched_warning': 0,
                                                                            'cell_poor_consistency_warning': 0,
                                                                            'insulation_warning': 0,
                                                                            'dcdc_temp_warning': 0,
                                                                            'brake_system_wanring': 0,
                                                                            'dcdc_state_warning': 0,
                                                                            'emotor_driver_temp_warning': 0,
                                                                            'hv_interlock_warning': 0,
                                                                            'emotor_temp_warning': 0,
                                                                            'pack_over_charged_warning': 0,
                                                                            'emotor_over_speed_warning': 0,
                                                                            'emotor_over_curr_warning': 0,
                                                                            'super_capacitor_over_temp_warning': 0,
                                                                            'super_capacitor_over_pressure_warning': 0,
                                                                            'pack_thermal_event_warning': 0,
                                                                            'hydrogen_leakage_warning': 0,
                                                                            'hydrogen_system_presure_abnormal_warning': 0,
                                                                            'hydrogen_system_temp_abnormal_warning': 0,
                                                                            'fuel_cell_stack_over_temp_warning': 0},
                                                        'pack_failures': [],
                                                        'emotor_failures': [],
                                                        'engine_failures': [],
                                                        'other_failures': ['00080002',
                                                                            '00090025',
                                                                            '00090026'],
                                                        'general_warning_list': []}},
                                    {'data_type': 'cell_volts',
                                        'data_content': [{'index': '1',
                                                        'volt': '713.8000000000001 V',
                                                        'curr': '2.200000000000273 V',
                                                        'cell_volts': ['3.9570000000000003 '
                                                                        'V',
                                                                        '3.96 V',
                                                                        '3.958 V',
                                                                        '3.9610000000000003 '
                                                                        'V',
                                                                        '3.959 V',
                                                                        '3.958 V',
                                                                        '3.9610000000000003 '
                                                                        'V',
                                                                        '3.962 V',
                                                                        '3.962 V',
                                                                        '3.964 V',
                                                                        '3.963 V',
                                                                        '3.964 V',
                                                                        '3.9650000000000003 '
                                                                        'V',
                                                                        '3.9650000000000003 '
                                                                        'V',
                                                                        '3.9650000000000003 '
                                                                        'V',
                                                                        '3.962 V',
                                                                        '3.962 V',
                                                                        '3.962 V',
                                                                        '3.963 V',
                                                                        '3.962 V',
                                                                        '3.963 V',
                                                                        '3.963 V',
                                                                        '3.964 V',
                                                                        '3.9650000000000003 '
                                                                        'V',
                                                                        '3.964 V',
                                                                        '3.964 V',
                                                                        '3.966 V',
                                                                        '3.964 V',
                                                                        '3.964 V',
                                                                        '3.962 V',
                                                                        '3.963 V',
                                                                        '3.963 V',
                                                                        '3.9650000000000003 '
                                                                        'V',
                                                                        '3.963 V',
                                                                        '3.9650000000000003 '
                                                                        'V',
                                                                        '3.9650000000000003 '
                                                                        'V',
                                                                        '3.9650000000000003 '
                                                                        'V',
                                                                        '3.9650000000000003 '
                                                                        'V',
                                                                        '3.9650000000000003 '
                                                                        'V',
                                                                        '3.964 V',
                                                                        '3.9650000000000003 '
                                                                        'V',
                                                                        '3.964 V',
                                                                        '3.964 V',
                                                                        '3.964 V',
                                                                        '3.9650000000000003 '
                                                                        'V',
                                                                        '3.9610000000000003 '
                                                                        'V',
                                                                        '3.96 V',
                                                                        '3.958 V',
                                                                        '3.964 V',
                                                                        '3.963 V',
                                                                        '3.964 V',
                                                                        '3.964 V',
                                                                        '3.964 V',
                                                                        '3.964 V',
                                                                        '3.964 V',
                                                                        '3.959 V',
                                                                        '3.9650000000000003 '
                                                                        'V',
                                                                        '3.96 V',
                                                                        '3.9650000000000003 '
                                                                        'V',
                                                                        '3.964 V',
                                                                        '3.964 V',
                                                                        '3.9650000000000003 '
                                                                        'V',
                                                                        '3.962 V',
                                                                        '3.967 V',
                                                                        '3.962 V',
                                                                        '3.9650000000000003 '
                                                                        'V',
                                                                        '3.964 V',
                                                                        '3.963 V',
                                                                        '3.964 V',
                                                                        '3.964 V',
                                                                        '3.9650000000000003 '
                                                                        'V',
                                                                        '3.964 V',
                                                                        '3.964 V',
                                                                        '3.967 V',
                                                                        '3.9650000000000003 '
                                                                        'V',
                                                                        '3.9650000000000003 '
                                                                        'V',
                                                                        '3.966 V',
                                                                        '3.9650000000000003 '
                                                                        'V',
                                                                        '3.9650000000000003 '
                                                                        'V',
                                                                        '3.966 V',
                                                                        '3.9650000000000003 '
                                                                        'V',
                                                                        '3.966 V',
                                                                        '3.966 V',
                                                                        '3.9650000000000003 '
                                                                        'V',
                                                                        '3.9650000000000003 '
                                                                        'V',
                                                                        '3.9650000000000003 '
                                                                        'V',
                                                                        '3.9650000000000003 '
                                                                        'V',
                                                                        '3.9650000000000003 '
                                                                        'V',
                                                                        '3.966 V',
                                                                        '3.966 V',
                                                                        '3.963 V',
                                                                        '3.964 V',
                                                                        '3.964 V',
                                                                        '3.964 V',
                                                                        '3.963 V',
                                                                        '3.963 V',
                                                                        '3.96 V',
                                                                        '3.964 V',
                                                                        '3.9650000000000003 '
                                                                        'V',
                                                                        '3.962 V',
                                                                        '3.964 V',
                                                                        '3.964 V',
                                                                        '3.964 V',
                                                                        '3.964 V',
                                                                        '3.964 V',
                                                                        '3.964 V',
                                                                        '3.9650000000000003 '
                                                                        'V',
                                                                        '3.962 V',
                                                                        '3.963 V',
                                                                        '3.962 V',
                                                                        '3.962 V',
                                                                        '3.964 V',
                                                                        '3.9650000000000003 '
                                                                        'V',
                                                                        '3.964 V',
                                                                        '3.9650000000000003 '
                                                                        'V',
                                                                        '3.9650000000000003 '
                                                                        'V',
                                                                        '3.964 V',
                                                                        '3.964 V',
                                                                        '3.963 V',
                                                                        '3.9650000000000003 '
                                                                        'V',
                                                                        '3.9610000000000003 '
                                                                        'V',
                                                                        '3.964 V',
                                                                        '3.963 V',
                                                                        '3.962 V',
                                                                        '3.964 V',
                                                                        '3.964 V',
                                                                        '3.964 V',
                                                                        '3.963 V',
                                                                        '3.964 V',
                                                                        '3.9650000000000003 '
                                                                        'V',
                                                                        '3.963 V',
                                                                        '3.9650000000000003 '
                                                                        'V',
                                                                        '3.964 V',
                                                                        '3.964 V',
                                                                        '3.964 V',
                                                                        '3.9610000000000003 '
                                                                        'V',
                                                                        '3.964 V',
                                                                        '3.964 V',
                                                                        '3.963 V',
                                                                        '3.964 V',
                                                                        '3.962 V',
                                                                        '3.9650000000000003 '
                                                                        'V',
                                                                        '3.963 V',
                                                                        '3.963 V',
                                                                        '3.964 V',
                                                                        '3.964 V',
                                                                        '3.964 V',
                                                                        '3.9650000000000003 '
                                                                        'V',
                                                                        '3.963 V',
                                                                        '3.963 V',
                                                                        '3.962 V',
                                                                        '3.964 V',
                                                                        '3.963 V',
                                                                        '3.964 V',
                                                                        '3.964 V',
                                                                        '3.9650000000000003 '
                                                                        'V',
                                                                        '3.964 V',
                                                                        '3.963 V',
                                                                        '3.963 V',
                                                                        '3.964 V',
                                                                        '3.963 V',
                                                                        '3.964 V',
                                                                        '3.964 V',
                                                                        '3.964 V',
                                                                        '3.964 V',
                                                                        '3.963 V',
                                                                        '3.964 V',
                                                                        '3.964 V',
                                                                        '3.9650000000000003 '
                                                                        'V',
                                                                        '3.964 V',
                                                                        '3.964 V',
                                                                        '3.964 V',
                                                                        '3.964 V',
                                                                        '3.964 V',
                                                                        '3.964 V',
                                                                        '3.9650000000000003 '
                                                                        'V',
                                                                        '3.9650000000000003 '
                                                                        'V',
                                                                        '3.9650000000000003 '
                                                                        'V',
                                                                        '3.9650000000000003 '
                                                                        'V',
                                                                        '3.9650000000000003 '
                                                                        'V']}]},
                                    {'data_type': 'probe_temps',
                                        'data_content': [{'index': '1',
                                                        'probe_temps': ['30 ℃',
                                                                        '30 ℃',
                                                                        '30 ℃',
                                                                        '29 ℃',
                                                                        '30 ℃',
                                                                        '30 ℃',
                                                                        '30 ℃',
                                                                        '30 ℃',
                                                                        '29 ℃',
                                                                        '28 ℃',
                                                                        '29 ℃',
                                                                        '29 ℃',
                                                                        '30 ℃',
                                                                        '30 ℃',
                                                                        '29 ℃',
                                                                        '28 ℃',
                                                                        '30 ℃',
                                                                        '30 ℃',
                                                                        '30 ℃',
                                                                        '30 ℃',
                                                                        '30 ℃',
                                                                        '30 ℃',
                                                                        '30 ℃',
                                                                        '30 ℃',
                                                                        '30 ℃',
                                                                        '31 ℃',
                                                                        '30 ℃',
                                                                        '30 ℃',
                                                                        '30 ℃',
                                                                        '30 ℃',
                                                                        '30 ℃',
                                                                        '30 ℃',
                                                                        '29 ℃',
                                                                        '28 ℃',
                                                                        '30 ℃',
                                                                        '30 ℃',
                                                                        '28 ℃',
                                                                        '29 ℃',
                                                                        '28 ℃',
                                                                        '27 ℃',
                                                                        '29 ℃',
                                                                        '30 ℃',
                                                                        '29 ℃',
                                                                        '29 ℃',
                                                                        '29 ℃',
                                                                        '29 ℃',
                                                                        '30 ℃',
                                                                        '29 ℃']}]},
                                    {'data_type': 131,
                                        'data_content': '000004190104230103dd0103f70100010001000100010101000105db0100ffffff0101'}],
                        'sig_starter': 'ff',
                        'sig': {'algo': 'rsa',
                                'r_len': 256,
                                'r_value': '2825085f0b2c0a294d47f6a8a738032f20bd7e5ede663a893c6c159f27e9154b7ac2d83e2fcbff21891237d29771e7c1f89552cc4eb82d480b291f5d253cc824908da0ee55ecd28a357fbb8013d7b371b4e0ac01061d34403871e645952c4d06d2fa25f374291af07f83e7b0e0d34fa29c5107866ca4561dfbcd2b72e04de52cfd5bbb6d66575189dc133db02cce0ef55ee2daab8d6de8d96e154e99f0cebeb0ecdc54e83aab694ae451e687b848735b0c6db777d63483c3c849fe2d2a39f895e6277670fd4ef586ea0cc65bfb6ace7a7be95ae695977f3377ea6b2187eae74ca021afc2646266af61a850695e441a4bbf6b807f1345897b38d86a8e90c1ed35',
                                's_len': 0,
                                's_value': ''}},
            'checksum': 230}
        ),
    ))